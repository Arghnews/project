<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>20.2. Vertex Input Description</title><link rel="stylesheet" type="text/css" href="config/vkspec-xhtml.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="Vulkan 1.0.30 - A Specification (with WSI extensions)" /><link rel="up" href="ch20.html" title="Chapter 20. Fixed-Function Vertex Processing" /><link rel="prev" href="ch20s01.html" title="20.1. Vertex Attributes" /><link rel="next" href="ch20s03.html" title="20.3. Example" /><script xmlns="" type="text/x-mathjax-config">
        MathJax.Hub.Config({
            MathML: { extensions: ["content-mathml.js"] },
            tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] }
        });
    </script><script xmlns="" type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="p" href="ch20s01.html"><img src="images/icons/prev.png" alt="Prev" /></a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch20s03.html"><img src="images/icons/next.png" alt="Next" /></a></td></tr></table><hr /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="fxvertex-input"></a>20.2. Vertex Input Description</h2></div></div></div><p>Applications specify vertex input attribute and vertex input binding
descriptions as part of graphics pipeline creation.
The <code class="code"><a class="link" href="ch09s02.html#VkGraphicsPipelineCreateInfo">VkGraphicsPipelineCreateInfo</a></code>::<em class="parameter"><code>pVertexInputState</code></em> points to a
structure of type <code class="code">VkPipelineVertexInputStateCreateInfo</code>.</p><p>The <code class="code">VkPipelineVertexInputStateCreateInfo</code> structure is defined as:</p><p><a id="VkPipelineVertexInputStateCreateInfo"></a><strong> </strong>
</p><pre class="programlisting">typedef struct VkPipelineVertexInputStateCreateInfo {
    VkStructureType                             sType;
    const void*                                 pNext;
    VkPipelineVertexInputStateCreateFlags       flags;
    uint32_t                                    vertexBindingDescriptionCount;
    const VkVertexInputBindingDescription*      pVertexBindingDescriptions;
    uint32_t                                    vertexAttributeDescriptionCount;
    const VkVertexInputAttributeDescription*    pVertexAttributeDescriptions;
} VkPipelineVertexInputStateCreateInfo;</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>sType</code></em> is the type of this structure.
</li><li class="listitem">
<em class="parameter"><code>pNext</code></em> is <code class="literal">NULL</code> or a pointer to an extension-specific structure.
</li><li class="listitem">
<em class="parameter"><code>flags</code></em> is reserved for future use.
</li><li class="listitem">
<em class="parameter"><code>vertexBindingDescriptionCount</code></em> is the number of vertex binding
    descriptions provided in <em class="parameter"><code>pVertexBindingDescriptions</code></em>.
</li><li class="listitem">
<em class="parameter"><code>pVertexBindingDescriptions</code></em> is a pointer to an array of
    <code class="code">VkVertexInputBindingDescription</code> structures.
</li><li class="listitem">
<em class="parameter"><code>vertexAttributeDescriptionCount</code></em> is the number of vertex attribute
    descriptions provided in <em class="parameter"><code>pVertexAttributeDescriptions</code></em>.
</li><li class="listitem">
<em class="parameter"><code>pVertexAttributeDescriptions</code></em> is a pointer to an array of
    <code class="code">VkVertexInputAttributeDescription</code> structures.
</li></ul></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>vertexBindingDescriptionCount</code></em> <span class="normative">must</span> be less than or equal to
    <code class="code">VkPhysicalDeviceLimits</code>::<em class="parameter"><code>maxVertexInputBindings</code></em>
</li><li class="listitem">
<em class="parameter"><code>vertexAttributeDescriptionCount</code></em> <span class="normative">must</span> be less than or equal to
    <code class="code">VkPhysicalDeviceLimits</code>::<em class="parameter"><code>maxVertexInputAttributes</code></em>
</li><li class="listitem">
For every <em class="parameter"><code>binding</code></em> specified by any given element of
    <em class="parameter"><code>pVertexAttributeDescriptions</code></em>, a
    <code class="code">VkVertexInputBindingDescription</code> <span class="normative">must</span> exist in
    <em class="parameter"><code>pVertexBindingDescriptions</code></em> with the same value of <em class="parameter"><code>binding</code></em>
</li><li class="listitem">
All elements of <em class="parameter"><code>pVertexBindingDescriptions</code></em> <span class="normative">must</span> describe distinct
    binding numbers
</li><li class="listitem">
All elements of <em class="parameter"><code>pVertexAttributeDescriptions</code></em> <span class="normative">must</span> describe
    distinct attribute locations
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>sType</code></em> <span class="normative">must</span> be <code class="code">VK_STRUCTURE_TYPE_PIPELINE_VERTEX_INPUT_STATE_CREATE_INFO</code>
</li><li class="listitem">
<em class="parameter"><code>pNext</code></em> <span class="normative">must</span> be <code class="literal">NULL</code>
</li><li class="listitem">
<em class="parameter"><code>flags</code></em> <span class="normative">must</span> be <code class="literal">0</code>
</li><li class="listitem">
If <em class="parameter"><code>vertexBindingDescriptionCount</code></em> is not <code class="literal">0</code>, <em class="parameter"><code>pVertexBindingDescriptions</code></em> <span class="normative">must</span> be a pointer to an array of <em class="parameter"><code>vertexBindingDescriptionCount</code></em> valid <code class="code">VkVertexInputBindingDescription</code> structures
</li><li class="listitem">
If <em class="parameter"><code>vertexAttributeDescriptionCount</code></em> is not <code class="literal">0</code>, <em class="parameter"><code>pVertexAttributeDescriptions</code></em> <span class="normative">must</span> be a pointer to an array of <em class="parameter"><code>vertexAttributeDescriptionCount</code></em> valid <code class="code">VkVertexInputAttributeDescription</code> structures
</li></ul></div></div><p>Each vertex input binding is specified by an instance of the
<code class="code">VkVertexInputBindingDescription</code> structure.</p><p>The <code class="code">VkVertexInputBindingDescription</code> structure is defined as:</p><p><a id="VkVertexInputBindingDescription"></a><strong> </strong>
</p><pre class="programlisting">typedef struct VkVertexInputBindingDescription {
    uint32_t             binding;
    uint32_t             stride;
    VkVertexInputRate    inputRate;
} VkVertexInputBindingDescription;</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>binding</code></em> is the binding number that this structure describes.
</li><li class="listitem">
<em class="parameter"><code>stride</code></em> is the distance in bytes between two consecutive elements
    within the buffer.
</li><li class="listitem"><p class="simpara">
<em class="parameter"><code>inputRate</code></em> specifies whether vertex attribute addressing is a
    function of the vertex index or of the instance index.
    Possible values include:
</p><p><a id="VkVertexInputRate"></a><strong> </strong>
</p><pre class="programlisting">typedef enum VkVertexInputRate {
    VK_VERTEX_INPUT_RATE_VERTEX = 0,
    VK_VERTEX_INPUT_RATE_INSTANCE = 1,
} VkVertexInputRate;</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<code class="code">VK_VERTEX_INPUT_RATE_VERTEX</code> indicates that vertex attribute
     addressing is a function of the vertex index.
</li><li class="listitem">
<code class="code">VK_VERTEX_INPUT_RATE_INSTANCE</code> indicates that vertex attribute
     addressing is a function of the instance index.
</li></ul></div></li></ul></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>binding</code></em> <span class="normative">must</span> be less than
    <code class="code">VkPhysicalDeviceLimits</code>::<em class="parameter"><code>maxVertexInputBindings</code></em>
</li><li class="listitem">
<em class="parameter"><code>stride</code></em> <span class="normative">must</span> be less than or equal to
    <code class="code">VkPhysicalDeviceLimits</code>::<em class="parameter"><code>maxVertexInputBindingStride</code></em>
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>inputRate</code></em> <span class="normative">must</span> be a valid <code class="code"><a class="link" href="ch20s02.html#VkVertexInputRate">VkVertexInputRate</a></code> value
</li></ul></div></div><p>Each vertex input attribute is specified by an instance of the
<code class="code">VkVertexInputAttributeDescription</code> structure.</p><p>The <code class="code">VkVertexInputAttributeDescription</code> structure is defined as:</p><p><a id="VkVertexInputAttributeDescription"></a><strong> </strong>
</p><pre class="programlisting">typedef struct VkVertexInputAttributeDescription {
    uint32_t    location;
    uint32_t    binding;
    VkFormat    format;
    uint32_t    offset;
} VkVertexInputAttributeDescription;</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>location</code></em> is the shader binding location number for this attribute.
</li><li class="listitem">
<em class="parameter"><code>binding</code></em> is the binding number which this attribute takes its data
    from.
</li><li class="listitem">
<em class="parameter"><code>format</code></em> is the size and type of the vertex attribute data.
</li><li class="listitem">
<em class="parameter"><code>offset</code></em> is a byte offset of this attribute relative to the start of
    an element in the vertex input binding.
</li></ul></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>location</code></em> <span class="normative">must</span> be less than
    <code class="code">VkPhysicalDeviceLimits</code>::<em class="parameter"><code>maxVertexInputAttributes</code></em>
</li><li class="listitem">
<em class="parameter"><code>binding</code></em> <span class="normative">must</span> be less than
    <code class="code">VkPhysicalDeviceLimits</code>::<em class="parameter"><code>maxVertexInputBindings</code></em>
</li><li class="listitem">
<em class="parameter"><code>offset</code></em> <span class="normative">must</span> be less than or equal to
    <code class="code">VkPhysicalDeviceLimits</code>::<em class="parameter"><code>maxVertexInputAttributeOffset</code></em>
</li><li class="listitem">
<em class="parameter"><code>format</code></em> <span class="normative">must</span> be allowed as a vertex buffer format, as specified by
    the <code class="code">VK_FORMAT_FEATURE_VERTEX_BUFFER_BIT</code> flag in
    <code class="code">VkFormatProperties</code>::<em class="parameter"><code>bufferFeatures</code></em> returned by
    <span class="strong"><strong><code class="code">vkGetPhysicalDeviceFormatProperties</code></strong></span>
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>format</code></em> <span class="normative">must</span> be a valid <code class="code"><a class="link" href="ch31s03.html#VkFormat">VkFormat</a></code> value
</li></ul></div></div><p>To bind vertex buffers to a command buffer for use in subsequent draw
commands, call:</p><p><a id="vkCmdBindVertexBuffers"></a><strong> </strong>
</p><pre class="programlisting">void vkCmdBindVertexBuffers(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    firstBinding,
    uint32_t                                    bindingCount,
    const VkBuffer*                             pBuffers,
    const VkDeviceSize*                         pOffsets);</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>commandBuffer</code></em> is the command buffer into which the command is
    recorded.
</li><li class="listitem">
<em class="parameter"><code>firstBinding</code></em> is the index of the first vertex input binding whose
    state is updated by the command.
</li><li class="listitem">
<em class="parameter"><code>bindingCount</code></em> is the number of vertex input bindings whose state is
    updated by the command.
</li><li class="listitem">
<em class="parameter"><code>pBuffers</code></em> is a pointer to an array of buffer handles.
</li><li class="listitem">
<em class="parameter"><code>pOffsets</code></em> is a pointer to an array of buffer offsets.
</li></ul></div><p>The values taken from elements <span class="eq">i</span> of <em class="parameter"><code>pBuffers</code></em> and <em class="parameter"><code>pOffsets</code></em>
replace the current state for the vertex input binding
<span class="eq"><em class="parameter"><code>firstBinding</code></em> + i</span>, for <span class="eq">i</span> in <span class="eq">[0, <em class="parameter"><code>bindingCount</code></em>)</span>.
The vertex input binding is updated to start at the offset indicated by
<em class="parameter"><code>pOffsets</code></em>[i] from the start of the buffer <em class="parameter"><code>pBuffers</code></em>[i].
All vertex input attributes that use each of these bindings will use these
updated addresses in their address calculations for subsequent draw
commands.</p><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>firstBinding</code></em> <span class="normative">must</span> be less than
    <code class="code">VkPhysicalDeviceLimits</code>::<em class="parameter"><code>maxVertexInputBindings</code></em>
</li><li class="listitem">
The sum of <em class="parameter"><code>firstBinding</code></em> and <em class="parameter"><code>bindingCount</code></em> <span class="normative">must</span> be less than
    or equal to <code class="code">VkPhysicalDeviceLimits</code>::<em class="parameter"><code>maxVertexInputBindings</code></em>
</li><li class="listitem">
All elements of <em class="parameter"><code>pOffsets</code></em> <span class="normative">must</span> be less than the size of the
    corresponding element in <em class="parameter"><code>pBuffers</code></em>
</li><li class="listitem">
All elements of <em class="parameter"><code>pBuffers</code></em> <span class="normative">must</span> have been created with the
    <code class="code">VK_BUFFER_USAGE_VERTEX_BUFFER_BIT</code> flag
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>commandBuffer</code></em> <span class="normative">must</span> be a valid <code class="code">VkCommandBuffer</code> handle
</li><li class="listitem">
<em class="parameter"><code>pBuffers</code></em> <span class="normative">must</span> be a pointer to an array of <em class="parameter"><code>bindingCount</code></em> valid <code class="code">VkBuffer</code> handles
</li><li class="listitem">
<em class="parameter"><code>pOffsets</code></em> <span class="normative">must</span> be a pointer to an array of <em class="parameter"><code>bindingCount</code></em> <code class="code">VkDeviceSize</code> values
</li><li class="listitem">
<em class="parameter"><code>commandBuffer</code></em> <span class="normative">must</span> be in the recording state
</li><li class="listitem">
The <code class="code">VkCommandPool</code> that <em class="parameter"><code>commandBuffer</code></em> was allocated from <span class="normative">must</span> support graphics operations
</li><li class="listitem">
<em class="parameter"><code>bindingCount</code></em> <span class="normative">must</span> be greater than <code class="literal">0</code>
</li><li class="listitem">
Both of <em class="parameter"><code>commandBuffer</code></em>, and the elements of <em class="parameter"><code>pBuffers</code></em> <span class="normative">must</span> have been created, allocated, or retrieved from the same <code class="code">VkDevice</code>
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Host Synchronization</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
Host access to <em class="parameter"><code>commandBuffer</code></em> <span class="normative">must</span> be externally synchronized
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Command Properties</strong></p></div></div></div><div class="informaltable"><table class="informaltable" cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; border-left: 3px solid #527bbd; border-right: 3px solid #527bbd; " width="100%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top">Command Buffer Levels</th><th style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top">Render Pass Scope</th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top">Supported Queue Types</th></tr></thead><tbody><tr><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><p>Primary
Secondary</p></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><p>Both</p></td><td style="" align="left" valign="top"><p>GRAPHICS</p></td></tr></tbody></table></div></div><p>The address of each attribute for each <span class="strong"><strong><code class="code">vertexIndex</code></strong></span> and
<span class="strong"><strong><code class="code">instanceIndex</code></strong></span> is calculated as follows:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
Let attribDesc be the member of
    <code class="code">VkPipelineVertexInputStateCreateInfo</code>::<em class="parameter"><code>pVertexAttributeDescriptions</code></em>
    with <code class="code">VkVertexInputAttributeDescription</code>::<em class="parameter"><code>location</code></em> equal to
    the vertex input attribute number.
</li><li class="listitem">
Let bindingDesc be the member of
    <code class="code">VkPipelineVertexInputStateCreateInfo</code>::<em class="parameter"><code>pVertexBindingDescriptions</code></em>
    with <code class="code">VkVertexInputAttributeDescription</code>::<em class="parameter"><code>binding</code></em> equal to
    attribDesc.binding.
</li><li class="listitem">
Let <span class="strong"><strong><code class="code">vertexIndex</code></strong></span> be the index of the vertex within the draw (a value
    between <em class="parameter"><code>firstVertex</code></em> and <em class="parameter"><code>firstVertex</code></em>+<em class="parameter"><code>vertexCount</code></em> for
    <span class="strong"><strong><code class="code">vkCmdDraw</code></strong></span>, or a value taken from the index buffer for
    <span class="strong"><strong><code class="code">vkCmdDrawIndexed</code></strong></span>), and let <span class="strong"><strong><code class="code">instanceIndex</code></strong></span> be the instance
    number of the draw (a value between <em class="parameter"><code>firstInstance</code></em> and
    <em class="parameter"><code>firstInstance</code></em>+<em class="parameter"><code>instanceCount</code></em>).
</li></ul></div><pre class="programlisting">bufferBindingAddress = buffer[binding].baseAddress + offset[binding];

if (bindingDesc.inputRate == VK_VERTEX_INPUT_RATE_VERTEX)
    vertexOffset = vertexIndex * bindingDesc.stride;
else
    vertexOffset = instanceIndex * bindingDesc.stride;

attribAddress = bufferBindingAddress + vertexOffset + attribDesc.offset;</pre><p><a id="fxvertex-input-extraction"></a>For each attribute, raw data is extracted starting at <code class="literal">attribAddress</code> and is
converted from the <code class="code">VkVertexInputAttributeDescription</code>’s <em class="parameter"><code>format</code></em> to
either to floating-point, unsigned integer, or signed integer based on the
base type of the format; the base type of the format <span class="normative">must</span> match the base
type of the input variable in the shader.
If <em class="parameter"><code>format</code></em> is a packed format, <code class="literal">attribAddress</code> <span class="normative">must</span> be a multiple of
the size in bytes of the whole attribute data type as described in
<a class="link" href="ch31s03.html#features-formats-packed" title="Packed Formats">Packed Formats</a>.
Otherwise, <code class="literal">attribAddress</code> <span class="normative">must</span> be a multiple of the size in bytes of the
component type indicated by <em class="parameter"><code>format</code></em> (see <a class="link" href="ch31s03.html" title="31.3. Formats">Formats</a>).
If the format does not include G, B, or A components, then those are filled
with <span class="eq">(0,0,1)</span> as needed (using either 1.0f or integer 1 based on the
format) for attributes that are not 64-bit data types.
The number of components in the vertex shader input variable need not
exactly match the number of components in the format.
If the vertex shader has fewer components, the extra components are
discarded.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch20s01.html"><img src="images/icons/prev.png" alt="Prev" /></a> </td><td width="20%" align="center"><a accesskey="u" href="ch20.html"><img src="images/icons/up.png" alt="Up" /></a></td><td width="40%" align="right"> <a accesskey="n" href="ch20s03.html"><img src="images/icons/next.png" alt="Next" /></a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/icons/home.png" alt="Home" /></a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>