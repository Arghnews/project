<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>26.1. Blending</title><link rel="stylesheet" type="text/css" href="config/vkspec-xhtml.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="Vulkan 1.0.30 - A Specification (with WSI extensions)" /><link rel="up" href="ch26.html" title="Chapter 26. The Framebuffer" /><link rel="prev" href="ch26.html" title="Chapter 26. The Framebuffer" /><link rel="next" href="ch26s02.html" title="26.2. Logical Operations" /><script xmlns="" type="text/x-mathjax-config">
        MathJax.Hub.Config({
            MathML: { extensions: ["content-mathml.js"] },
            tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] }
        });
    </script><script xmlns="" type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="p" href="ch26.html"><img src="images/icons/prev.png" alt="Prev" /></a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch26s02.html"><img src="images/icons/next.png" alt="Next" /></a></td></tr></table><hr /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="framebuffer-blending"></a>26.1. Blending</h2></div></div></div><p>Blending combines the incoming <span class="emphasis"><em>source</em></span> fragment’s R, G, B, and A values
with the <span class="emphasis"><em>destination</em></span> R, G, B, and A values of each sample stored in the
framebuffer at the fragment’s <span class="eq">(x<sub>f</sub>,y<sub>f</sub>)</span> location.
Blending is performed for each pixel sample, rather than just once for each
fragment.</p><p>Source and destination values are combined according to the
<a class="link" href="ch26s01.html#framebuffer-blendoperations" title="26.1.3. Blend Operations">blend operation</a>, quadruplets of source and
destination weighting factors determined by the <a class="link" href="ch26s01.html#framebuffer-blendfactors" title="26.1.1. Blend Factors">blend factors</a>, and a <a class="link" href="ch26s01.html#framebuffer-blendconstants">blend constant</a>, to
obtain a new set of R, G, B, and A values, as described below.</p><p>Blending is computed and applied separately to each color attachment used by
the subpass, with separate controls for each attachment.</p><p>Prior to performing the blend operation, signed and unsigned normalized
fixed-point color components undergo an implied conversion to floating-point
as specified by <a class="link" href="ch02s08.html#fundamentals-fixedfpconv" title="2.8.1. Conversion from Normalized Fixed-Point to Floating-Point">Conversion from Normalized Fixed-Point to Floating-Point</a>.
Blending computations are treated as if carried out in floating-point, and
will be performed with a precision and dynamic range no lower than that used
to represent destination components.</p><p>Blending applies only to fixed-point and floating-point color attachments.
If the color attachment has an integer format, blending is not applied.</p><p>The pipeline blend state is included in the
<code class="code">VkPipelineColorBlendStateCreateInfo</code> structure during graphics pipeline
creation:</p><p>The <code class="code">VkPipelineColorBlendStateCreateInfo</code> structure is defined as:</p><p><a id="VkPipelineColorBlendStateCreateInfo"></a><strong> </strong>
</p><pre class="programlisting">typedef struct VkPipelineColorBlendStateCreateInfo {
    VkStructureType                               sType;
    const void*                                   pNext;
    VkPipelineColorBlendStateCreateFlags          flags;
    VkBool32                                      logicOpEnable;
    VkLogicOp                                     logicOp;
    uint32_t                                      attachmentCount;
    const VkPipelineColorBlendAttachmentState*    pAttachments;
    float                                         blendConstants[4];
} VkPipelineColorBlendStateCreateInfo;</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>sType</code></em> is the type of this structure.
</li><li class="listitem">
<em class="parameter"><code>pNext</code></em> is <code class="literal">NULL</code> or a pointer to an extension-specific structure.
</li><li class="listitem">
<em class="parameter"><code>flags</code></em> is reserved for future use.
</li><li class="listitem">
<em class="parameter"><code>logicOpEnable</code></em> controls whether to apply <a class="link" href="ch26s02.html" title="26.2. Logical Operations">Logical Operations</a>.
</li><li class="listitem">
<em class="parameter"><code>logicOp</code></em> selects which logical operation to apply.
</li><li class="listitem">
<em class="parameter"><code>attachmentCount</code></em> is the number of
    <code class="code">VkPipelineColorBlendAttachmentState</code> elements in
    <em class="parameter"><code>pAttachments</code></em>.
    This value <span class="normative">must</span> equal the <em class="parameter"><code>colorAttachmentCount</code></em> for the subpass in
    which this pipeline is used.
</li><li class="listitem">
<em class="parameter"><code>pAttachments</code></em>: is a pointer to array of per target attachment
    states.
</li><li class="listitem">
<em class="parameter"><code>blendConstants</code></em> is an array of four values used as the R, G, B, and
    A components of the blend constant that are used in blending, depending
    on the <a class="link" href="ch26s01.html#framebuffer-blendfactors" title="26.1.1. Blend Factors">blend factor</a>.
</li></ul></div><p>Each element of the <em class="parameter"><code>pAttachments</code></em> array is a
<code class="code"><a class="link" href="ch26s01.html#VkPipelineColorBlendAttachmentState">VkPipelineColorBlendAttachmentState</a></code> structure specifying per-target
blending state for each individual color attachment.
If the <a class="link" href="ch31s01.html#features-features-independentBlend">independent blending</a> feature
is not enabled on the device, all <code class="code"><a class="link" href="ch26s01.html#VkPipelineColorBlendAttachmentState">VkPipelineColorBlendAttachmentState</a></code>
elements in the <em class="parameter"><code>pAttachments</code></em> array <span class="normative">must</span> be identical.</p><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
If the <a class="link" href="ch31s01.html#features-features-independentBlend">independent blending</a>
    feature is not enabled, all elements of <em class="parameter"><code>pAttachments</code></em> <span class="normative">must</span> be
    identical
</li><li class="listitem">
If the <a class="link" href="ch31s01.html#features-features-logicOp">logic operations</a> feature is not
    enabled, <em class="parameter"><code>logicOpEnable</code></em> <span class="normative">must</span> be <code class="code">VK_FALSE</code>
</li><li class="listitem">
If <em class="parameter"><code>logicOpEnable</code></em> is <code class="code">VK_TRUE</code>, <em class="parameter"><code>logicOp</code></em> <span class="normative">must</span> be a valid
    <code class="code"><a class="link" href="ch26s02.html#VkLogicOp">VkLogicOp</a></code> value
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>sType</code></em> <span class="normative">must</span> be <code class="code">VK_STRUCTURE_TYPE_PIPELINE_COLOR_BLEND_STATE_CREATE_INFO</code>
</li><li class="listitem">
<em class="parameter"><code>pNext</code></em> <span class="normative">must</span> be <code class="literal">NULL</code>
</li><li class="listitem">
<em class="parameter"><code>flags</code></em> <span class="normative">must</span> be <code class="literal">0</code>
</li><li class="listitem">
If <em class="parameter"><code>attachmentCount</code></em> is not <code class="literal">0</code>, <em class="parameter"><code>pAttachments</code></em> <span class="normative">must</span> be a pointer to an array of <em class="parameter"><code>attachmentCount</code></em> valid <code class="code">VkPipelineColorBlendAttachmentState</code> structures
</li></ul></div></div><p>The <code class="code">VkPipelineColorBlendAttachmentState</code> structure is defined as:</p><p><a id="VkPipelineColorBlendAttachmentState"></a><strong> </strong>
</p><pre class="programlisting">typedef struct VkPipelineColorBlendAttachmentState {
    VkBool32                 blendEnable;
    VkBlendFactor            srcColorBlendFactor;
    VkBlendFactor            dstColorBlendFactor;
    VkBlendOp                colorBlendOp;
    VkBlendFactor            srcAlphaBlendFactor;
    VkBlendFactor            dstAlphaBlendFactor;
    VkBlendOp                alphaBlendOp;
    VkColorComponentFlags    colorWriteMask;
} VkPipelineColorBlendAttachmentState;</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>blendEnable</code></em> controls whether blending is enabled for the
    corresponding color attachment.
    If blending is not enabled, the source fragment’s color for that
    attachment is passed through unmodified.
</li><li class="listitem">
<em class="parameter"><code>srcColorBlendFactor</code></em> selects which blend factor is used to
    determine the source factors <span class="eq">(S<sub>r</sub>,S<sub>g</sub>,S<sub>b</sub>)</span>.
</li><li class="listitem">
<em class="parameter"><code>dstColorBlendFactor</code></em> selects which blend factor is used to
    determine the destination factors <span class="eq">(D<sub>r</sub>,D<sub>g</sub>,D<sub>b</sub>)</span>.
</li><li class="listitem">
<em class="parameter"><code>colorBlendOp</code></em> selects which blend operation is used to calculate
    the RGB values to write to the color attachment.
</li><li class="listitem">
<em class="parameter"><code>srcAlphaBlendFactor</code></em> selects which blend factor is used to
    determine the source factor <span class="eq">S<sub>a</sub></span>.
</li><li class="listitem">
<em class="parameter"><code>dstAlphaBlendFactor</code></em> selects which blend factor is used to
    determine the destination factor <span class="eq">D<sub>a</sub></span>.
</li><li class="listitem">
<em class="parameter"><code>alphaBlendOp</code></em> selects which blend operation is use to calculate the
    alpha values to write to the color attachment.
</li><li class="listitem">
<em class="parameter"><code>colorWriteMask</code></em> is a bitmask selecting which of the R, G, B, and/or
    A components are enabled for writing, as described later in this
    chapter.
</li></ul></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
If the <a class="link" href="ch31s01.html#features-features-dualSrcBlend">dual source blending</a> feature
    is not enabled, <em class="parameter"><code>srcColorBlendFactor</code></em> <span class="normative">must</span> not be
    <code class="code">VK_BLEND_FACTOR_SRC1_COLOR</code>,
    <code class="code">VK_BLEND_FACTOR_ONE_MINUS_SRC1_COLOR</code>,
    <code class="code">VK_BLEND_FACTOR_SRC1_ALPHA</code>, or
    <code class="code">VK_BLEND_FACTOR_ONE_MINUS_SRC1_ALPHA</code>
</li><li class="listitem">
If the <a class="link" href="ch31s01.html#features-features-dualSrcBlend">dual source blending</a> feature
    is not enabled, <em class="parameter"><code>dstColorBlendFactor</code></em> <span class="normative">must</span> not be
    <code class="code">VK_BLEND_FACTOR_SRC1_COLOR</code>,
    <code class="code">VK_BLEND_FACTOR_ONE_MINUS_SRC1_COLOR</code>,
    <code class="code">VK_BLEND_FACTOR_SRC1_ALPHA</code>, or
    <code class="code">VK_BLEND_FACTOR_ONE_MINUS_SRC1_ALPHA</code>
</li><li class="listitem">
If the <a class="link" href="ch31s01.html#features-features-dualSrcBlend">dual source blending</a> feature
    is not enabled, <em class="parameter"><code>srcAlphaBlendFactor</code></em> <span class="normative">must</span> not be
    <code class="code">VK_BLEND_FACTOR_SRC1_COLOR</code>,
    <code class="code">VK_BLEND_FACTOR_ONE_MINUS_SRC1_COLOR</code>,
    <code class="code">VK_BLEND_FACTOR_SRC1_ALPHA</code>, or
    <code class="code">VK_BLEND_FACTOR_ONE_MINUS_SRC1_ALPHA</code>
</li><li class="listitem">
If the <a class="link" href="ch31s01.html#features-features-dualSrcBlend">dual source blending</a> feature
    is not enabled, <em class="parameter"><code>dstAlphaBlendFactor</code></em> <span class="normative">must</span> not be
    <code class="code">VK_BLEND_FACTOR_SRC1_COLOR</code>,
    <code class="code">VK_BLEND_FACTOR_ONE_MINUS_SRC1_COLOR</code>,
    <code class="code">VK_BLEND_FACTOR_SRC1_ALPHA</code>, or
    <code class="code">VK_BLEND_FACTOR_ONE_MINUS_SRC1_ALPHA</code>
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>srcColorBlendFactor</code></em> <span class="normative">must</span> be a valid <code class="code"><a class="link" href="ch26s01.html#VkBlendFactor">VkBlendFactor</a></code> value
</li><li class="listitem">
<em class="parameter"><code>dstColorBlendFactor</code></em> <span class="normative">must</span> be a valid <code class="code"><a class="link" href="ch26s01.html#VkBlendFactor">VkBlendFactor</a></code> value
</li><li class="listitem">
<em class="parameter"><code>colorBlendOp</code></em> <span class="normative">must</span> be a valid <code class="code"><a class="link" href="ch26s01.html#VkBlendOp">VkBlendOp</a></code> value
</li><li class="listitem">
<em class="parameter"><code>srcAlphaBlendFactor</code></em> <span class="normative">must</span> be a valid <code class="code"><a class="link" href="ch26s01.html#VkBlendFactor">VkBlendFactor</a></code> value
</li><li class="listitem">
<em class="parameter"><code>dstAlphaBlendFactor</code></em> <span class="normative">must</span> be a valid <code class="code"><a class="link" href="ch26s01.html#VkBlendFactor">VkBlendFactor</a></code> value
</li><li class="listitem">
<em class="parameter"><code>alphaBlendOp</code></em> <span class="normative">must</span> be a valid <code class="code"><a class="link" href="ch26s01.html#VkBlendOp">VkBlendOp</a></code> value
</li><li class="listitem">
<em class="parameter"><code>colorWriteMask</code></em> <span class="normative">must</span> be a valid combination of <code class="code"><a class="link" href="ch26s01.html#VkColorComponentFlagBits">VkColorComponentFlagBits</a></code> values
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="framebuffer-blendfactors"></a>26.1.1. Blend Factors</h3></div></div></div><p>The source and destination color and alpha blending factors are selected
from the enum:</p><p><a id="VkBlendFactor"></a><strong> </strong>
</p><pre class="programlisting">typedef enum VkBlendFactor {
    VK_BLEND_FACTOR_ZERO = 0,
    VK_BLEND_FACTOR_ONE = 1,
    VK_BLEND_FACTOR_SRC_COLOR = 2,
    VK_BLEND_FACTOR_ONE_MINUS_SRC_COLOR = 3,
    VK_BLEND_FACTOR_DST_COLOR = 4,
    VK_BLEND_FACTOR_ONE_MINUS_DST_COLOR = 5,
    VK_BLEND_FACTOR_SRC_ALPHA = 6,
    VK_BLEND_FACTOR_ONE_MINUS_SRC_ALPHA = 7,
    VK_BLEND_FACTOR_DST_ALPHA = 8,
    VK_BLEND_FACTOR_ONE_MINUS_DST_ALPHA = 9,
    VK_BLEND_FACTOR_CONSTANT_COLOR = 10,
    VK_BLEND_FACTOR_ONE_MINUS_CONSTANT_COLOR = 11,
    VK_BLEND_FACTOR_CONSTANT_ALPHA = 12,
    VK_BLEND_FACTOR_ONE_MINUS_CONSTANT_ALPHA = 13,
    VK_BLEND_FACTOR_SRC_ALPHA_SATURATE = 14,
    VK_BLEND_FACTOR_SRC1_COLOR = 15,
    VK_BLEND_FACTOR_ONE_MINUS_SRC1_COLOR = 16,
    VK_BLEND_FACTOR_SRC1_ALPHA = 17,
    VK_BLEND_FACTOR_ONE_MINUS_SRC1_ALPHA = 18,
} VkBlendFactor;</pre><p>
</p><p>The semantics of each enum value is described in the table below:</p><div class="table"><a id="id-1.28.2.19.5"></a><p class="title"><strong>Table 26.1. Blend Factors</strong></p><div class="table-contents"><table class="table" summary="Blend Factors" cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; border-left: 3px solid #527bbd; border-right: 3px solid #527bbd; " width="100%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top">VkBlendFactor                                  </th><th style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"> RGB Blend Factors <span class="eq">(S<sub>r</sub>,S<sub>g</sub>,S<sub>b</sub>)</span> or <span class="eq">(D<sub>r</sub>,D<sub>g</sub>,D<sub>b</sub>)</span> </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Alpha Blend Factor (<span class="eq">S<sub>a</sub></span> or <span class="eq">D<sub>a</sub></span>)</th></tr></thead><tbody><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_FACTOR_ZERO</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">(0,0,0)</span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">0</span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_FACTOR_ONE</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">(1,1,1)</span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">1</span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_FACTOR_SRC_COLOR</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">(R<sub>s0</sub>,G<sub>s0</sub>,B<sub>s0</sub>)</span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">A<sub>s0</sub></span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_FACTOR_ONE_MINUS_SRC_COLOR</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">(1-R<sub>s0</sub>,1-G<sub>s0</sub>,1-B<sub>s0</sub>)</span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">1-A<sub>s0</sub></span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_FACTOR_DST_COLOR</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">(R<sub>d</sub>,G<sub>d</sub>,B<sub>d</sub>)</span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">A<sub>d</sub></span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_FACTOR_ONE_MINUS_DST_COLOR</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">(1-R<sub>d</sub>,1-G<sub>d</sub>,1-B<sub>d</sub>)</span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">1-A<sub>d</sub></span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_FACTOR_SRC_ALPHA</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">(A<sub>s0</sub>,A<sub>s0</sub>,A<sub>s0</sub>)</span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">A<sub>s0</sub></span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_FACTOR_ONE_MINUS_SRC_ALPHA</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">(1-A<sub>s0</sub>,1-A<sub>s0</sub>,1-A<sub>s0</sub>)</span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">1-A<sub>s0</sub></span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_FACTOR_DST_ALPHA</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">(A<sub>d</sub>,A<sub>d</sub>,A<sub>d</sub>)</span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">A<sub>d</sub></span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_FACTOR_ONE_MINUS_DST_ALPHA</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">(1-A<sub>d</sub>,1-A<sub>d</sub>,1-A<sub>d</sub>)</span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">1-A<sub>d</sub></span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_FACTOR_CONSTANT_COLOR</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">(R<sub>c</sub>,G<sub>c</sub>,B<sub>c</sub>)</span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">A<sub>c</sub></span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_FACTOR_ONE_MINUS_CONSTANT_COLOR</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">(1-R<sub>c</sub>,1-G<sub>c</sub>,1-B<sub>c</sub>)</span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">1-A<sub>c</sub></span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_FACTOR_CONSTANT_ALPHA</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">(A<sub>c</sub>,A<sub>c</sub>,A<sub>c</sub>)</span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">A<sub>c</sub></span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_FACTOR_ONE_MINUS_CONSTANT_ALPHA</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">(1-A<sub>c</sub>,1-A<sub>c</sub>,1-A<sub>c</sub>)</span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">1-A<sub>c</sub></span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_FACTOR_SRC_ALPHA_SATURATE</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">(f,f,f)</span>; <span class="eq">f = min(A<sub>s0</sub>,1-A<sub>d</sub>)</span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">1</span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_FACTOR_SRC1_COLOR</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">(R<sub>s1</sub>,G<sub>s1</sub>,B<sub>s1</sub>)</span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">A<sub>s1</sub></span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_FACTOR_ONE_MINUS_SRC1_COLOR</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">(1-R<sub>s1</sub>,1-G<sub>s1</sub>,1-B<sub>s1</sub>)</span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">1-A<sub>s1</sub></span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_FACTOR_SRC1_ALPHA</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">(A<sub>s1</sub>,A<sub>s1</sub>,A<sub>s1</sub>)</span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">A<sub>s1</sub></span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_FACTOR_ONE_MINUS_SRC1_ALPHA</code></p></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">(1-A<sub>s1</sub>,1-A<sub>s1</sub>,1-A<sub>s1</sub>)</span></p></td><td style="" align="left" valign="top"><p><span class="eq">1-A<sub>s1</sub></span></p></td></tr></tbody></table></div></div><br class="table-break" /><p>In this table, the following conventions are used:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="eq">R<sub>s0</sub>,G<sub>s0</sub>,B<sub>s0</sub></span> and <span class="eq">A<sub>s0</sub></span> represent the first source color
    R, G, B, and A components, respectively, for the fragment output
    location corresponding to the color attachment being blended.
</li><li class="listitem">
<span class="eq">R<sub>s1</sub>,G<sub>s1</sub>,B<sub>s1</sub></span> and <span class="eq">A<sub>s1</sub></span> represent the second source
    color R, G, B, and A components, respectively, used in dual source
    blending modes, for the fragment output location corresponding to the
    color attachment being blended.
</li><li class="listitem">
<span class="eq">R<sub>d</sub>,G<sub>d</sub>,B<sub>d</sub></span> and <span class="eq">A<sub>d</sub></span> represent the R, G, B, and A
    components of the destination color.
    That is, the color currently in the corresponding color attachment for
    this fragment/sample.
</li><li class="listitem">
<span class="eq">R<sub>c</sub>,G<sub>c</sub>,B<sub>c</sub></span> and <span class="eq">A<sub>c</sub></span> represent the blend constant R, G,
    B, and A components, respectively.
</li></ul></div><p><a id="framebuffer-blendconstants"></a>If the pipeline state object is created without the
<code class="code">VK_DYNAMIC_STATE_BLEND_CONSTANTS</code> dynamic state enabled then the <span class="emphasis"><em>blend
constant</em></span> <span class="eq">(R<sub>c</sub>,G<sub>c</sub>,B<sub>c</sub>,A<sub>c</sub>)</span> is specified via the
<em class="parameter"><code>blendConstants</code></em> member of <code class="code"><a class="link" href="ch26s01.html#VkPipelineColorBlendStateCreateInfo">VkPipelineColorBlendStateCreateInfo</a></code>.</p><p>Otherwise, to dynamically set and change the blend constant, call:</p><p><a id="vkCmdSetBlendConstants"></a><strong> </strong>
</p><pre class="programlisting">void vkCmdSetBlendConstants(
    VkCommandBuffer                             commandBuffer,
    const float                                 blendConstants[4]);</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>commandBuffer</code></em> is the command buffer into which the command will be
    recorded.
</li><li class="listitem">
<em class="parameter"><code>blendConstants</code></em> is an array of four values specifying the R, G, B,
    and A components of the blend constant color used in blending, depending
    on the <a class="link" href="ch26s01.html#framebuffer-blendfactors" title="26.1.1. Blend Factors">blend factor</a>.
</li></ul></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
The currently bound graphics pipeline <span class="normative">must</span> have been created with the
    <code class="code">VK_DYNAMIC_STATE_BLEND_CONSTANTS</code> dynamic state enabled
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>commandBuffer</code></em> <span class="normative">must</span> be a valid <code class="code">VkCommandBuffer</code> handle
</li><li class="listitem">
<em class="parameter"><code>commandBuffer</code></em> <span class="normative">must</span> be in the recording state
</li><li class="listitem">
The <code class="code">VkCommandPool</code> that <em class="parameter"><code>commandBuffer</code></em> was allocated from <span class="normative">must</span> support graphics operations
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Host Synchronization</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
Host access to <em class="parameter"><code>commandBuffer</code></em> <span class="normative">must</span> be externally synchronized
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Command Properties</strong></p></div></div></div><div class="informaltable"><table class="informaltable" cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; border-left: 3px solid #527bbd; border-right: 3px solid #527bbd; " width="100%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top">Command Buffer Levels</th><th style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top">Render Pass Scope</th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top">Supported Queue Types</th></tr></thead><tbody><tr><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><p>Primary
Secondary</p></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><p>Both</p></td><td style="" align="left" valign="top"><p>GRAPHICS</p></td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="framebuffer-dsb"></a>26.1.2. Dual-Source Blending</h3></div></div></div><p>Blend factors that use the secondary color input
<span class="eq">(R<sub>s1</sub>,G<sub>s1</sub>,B<sub>s1</sub>,A<sub>s1</sub>)</span> (<code class="code">VK_BLEND_FACTOR_SRC1_COLOR</code>,
<code class="code">VK_BLEND_FACTOR_ONE_MINUS_SRC1_COLOR</code>,
<code class="code">VK_BLEND_FACTOR_SRC1_ALPHA</code>, and
<code class="code">VK_BLEND_FACTOR_ONE_MINUS_SRC1_ALPHA</code>) <span class="normative">may</span> consume hardware resources
that could otherwise be used for rendering to multiple color attachments.
Therefore, the number of color attachments that <span class="normative">can</span> be used in a
framebuffer <span class="normative">may</span> be lower when using dual-source blending.</p><p>Dual-source blending is only supported if the
<a class="link" href="ch31s01.html#features-features-dualSrcBlend"><em class="parameter"><code>dualSrcBlend</code></em></a> feature is enabled.</p><p>The maximum number of color attachments that <span class="normative">can</span> be used in a subpass when
using dual-source blending functions is implementation-dependent and is
reported as the <em class="parameter"><code>maxFragmentDualSrcAttachments</code></em> member of
<code class="code">VkPhysicalDeviceLimits</code>.</p><p>When using a fragment shader with dual-source blending functions, the color
outputs are bound to the first and second inputs of the blender using the
<span class="strong"><strong><code class="code">Index</code></strong></span> decoration, as described in <a class="link" href="ch14s03.html" title="14.3. Fragment Output Interface">Fragment Output Interface</a>.
If the second color input to the blender is not written in the shader, or if
no output is bound to the second input of a blender, the result of the
blending operation is not defined.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="framebuffer-blendoperations"></a>26.1.3. Blend Operations</h3></div></div></div><p>Once the source and destination blend factors have been selected, they along
with the source and destination components are passed to the blending
operation.
The blending operations are selected from the following enum, with RGB and
alpha components potentially using different blend operations:</p><p><a id="VkBlendOp"></a><strong> </strong>
</p><pre class="programlisting">typedef enum VkBlendOp {
    VK_BLEND_OP_ADD = 0,
    VK_BLEND_OP_SUBTRACT = 1,
    VK_BLEND_OP_REVERSE_SUBTRACT = 2,
    VK_BLEND_OP_MIN = 3,
    VK_BLEND_OP_MAX = 4,
} VkBlendOp;</pre><p>
</p><p></p><p>The semantics of each enum value is described in the table below:</p><div class="table"><a id="id-1.28.2.21.6"></a><p class="title"><strong>Table 26.2. Blend Operations</strong></p><div class="table-contents"><table class="table" summary="Blend Operations" cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; border-left: 3px solid #527bbd; border-right: 3px solid #527bbd; " width="100%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top">VkBlendOp                                   </th><th style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"> RGB Components                    </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> Alpha Component</th></tr></thead><tbody><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_OP_ADD</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">R = R<sub>s0</sub> × S<sub>r</sub> + R<sub>d</sub> × D<sub>r</sub></span>
  <span class="eq">G = G<sub>s0</sub> × S<sub>g</sub> + G<sub>d</sub> × D<sub>g</sub></span>
  <span class="eq">B = B<sub>s0</sub> × S<sub>b</sub> + B<sub>d</sub> × D<sub>b</sub></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">A = A<sub>s0</sub> × S<sub>a</sub> + A<sub>d</sub> × D<sub>a</sub></span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_OP_SUBTRACT</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">R = R<sub>s0</sub> × S<sub>r</sub> - R<sub>d</sub> × D<sub>r</sub></span>
  <span class="eq">G = G<sub>s0</sub> × S<sub>g</sub> - G<sub>d</sub> × D<sub>g</sub></span>
  <span class="eq">B = B<sub>s0</sub> × S<sub>b</sub> - B<sub>d</sub> × D<sub>b</sub></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">A = A<sub>s0</sub> × S<sub>a</sub> - A<sub>d</sub> × D<sub>a</sub></span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_OP_REVERSE_SUBTRACT</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">R = R<sub>d</sub> × D<sub>r</sub> - R<sub>s0</sub> × S<sub>r</sub></span>
  <span class="eq">G = G<sub>d</sub> × D<sub>g</sub> - G<sub>s0</sub> × S<sub>g</sub></span>
  <span class="eq">B = B<sub>d</sub> × D<sub>b</sub> - B<sub>s0</sub> × S<sub>b</sub></span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">A = A<sub>d</sub> × D<sub>a</sub> - A<sub>s0</sub> × S<sub>a</sub></span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_OP_MIN</code></p></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">R = min(R<sub>s0</sub>,R<sub>d</sub>)</span>
  <span class="eq">G = min(G<sub>s0</sub>,G<sub>d</sub>)</span>
  <span class="eq">B = min(B<sub>s0</sub>,B<sub>d</sub>)</span></p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">A = min(A<sub>s0</sub>,A<sub>d</sub>)</span></p></td></tr><tr><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><p><code class="code">VK_BLEND_OP_MAX</code></p></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><p><span class="eq">R = max(R<sub>s0</sub>,R<sub>d</sub>)</span>
  <span class="eq">G = max(G<sub>s0</sub>,G<sub>d</sub>)</span>
  <span class="eq">B = max(B<sub>s0</sub>,B<sub>d</sub>)</span></p></td><td style="" align="left" valign="top"><p><span class="eq">A = max(A<sub>s0</sub>,A<sub>d</sub>)</span></p></td></tr></tbody></table></div></div><br class="table-break" /><p>In this table, the following conventions are used:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="eq">R<sub>s0</sub>, G<sub>s0</sub>, B<sub>s0</sub></span> and <span class="eq">A<sub>s0</sub></span> represent the first source
    color R, G, B, and A components, respectively.
</li><li class="listitem">
<span class="eq">R<sub>d</sub>, G<sub>d</sub>, B<sub>d</sub></span> and <span class="eq">A<sub>d</sub></span> represent the R, G, B, and A
    components of the destination color.
    That is, the color currently in the corresponding color attachment for
    this fragment/sample.
</li><li class="listitem">
<span class="eq">S<sub>r</sub>, S<sub>g</sub>, S<sub>b</sub></span> and <span class="eq">S<sub>a</sub></span> represent the source blend factor
    R, G, B, and A components, respectively.
</li><li class="listitem">
<span class="eq">D<sub>r</sub>, D<sub>g</sub>, D<sub>b</sub></span> and <span class="eq">D<sub>a</sub></span> represent the destination blend
    factor R, G, B, and A components, respectively.
</li></ul></div><p>The blending operation produces a new set of values <span class="eq">R, G, B</span> and
<span class="eq">A</span>, which are written to the framebuffer attachment.
If blending is not enabled for this attachment, then <span class="eq">R, G, B</span> and
<span class="eq">A</span> are assigned <span class="eq">R<sub>s0</sub>, G<sub>s0</sub>, B<sub>s0</sub></span> and <span class="eq">A<sub>s0</sub></span>,
respectively.</p><p>If the color attachment is fixed-point, the components of the source and
destination values and blend factors are each clamped to <span class="eq">[0,1]</span> or
<span class="eq">[-1,1]</span> respectively for an unsigned normalized or signed normalized
color attachment prior to evaluating the blend operations.
If the color attachment is floating-point, no clamping occurs.</p><p>The <em class="parameter"><code>colorWriteMask</code></em> member of <code class="code"><a class="link" href="ch26s01.html#VkPipelineColorBlendAttachmentState">VkPipelineColorBlendAttachmentState</a></code>
determines whether the final color values <span class="eq">R, G, B</span> and <span class="eq">A</span> are
written to the framebuffer attachment.
<em class="parameter"><code>colorWriteMask</code></em> is any combination of the following bits:</p><p><a id="VkColorComponentFlagBits"></a><strong> </strong>
</p><pre class="programlisting">typedef enum VkColorComponentFlagBits {
    VK_COLOR_COMPONENT_R_BIT = 0x00000001,
    VK_COLOR_COMPONENT_G_BIT = 0x00000002,
    VK_COLOR_COMPONENT_B_BIT = 0x00000004,
    VK_COLOR_COMPONENT_A_BIT = 0x00000008,
} VkColorComponentFlagBits;</pre><p>
</p><p>If <code class="code">VK_COLOR_COMPONENT_R_BIT</code> is set, then the <span class="eq">R</span> value is written
to color attachment for the appropriate sample, otherwise the value in
memory is unmodified.
The <code class="code">VK_COLOR_COMPONENT_G_BIT</code>, <code class="code">VK_COLOR_COMPONENT_B_BIT</code>, and
<code class="code">VK_COLOR_COMPONENT_A_BIT</code> bits similarly control writing of the <span class="eq">G,
B,</span> and <span class="eq">A</span> values.
The <em class="parameter"><code>colorWriteMask</code></em> is applied regardless of whether blending is
enabled.</p><p>If the numeric format of a framebuffer attachment uses sRGB encoding, the R,
G, and B destination color values (after conversion from fixed-point to
floating-point) are considered to be encoded for the sRGB color space and
hence are linearized prior to their use in blending.
Each R, G, and B component is converted from nonlinear to linear as
described in the “KHR_DF_TRANSFER_SRGB” section of the
<a class="link" href="ch01s04.html#data-format">Khronos Data Format Specification</a>.
If the format is not sRGB, no linearization is performed.</p><p>If the numeric format of a framebuffer attachment uses sRGB encoding, then
the final R, G and B values are converted into the nonlinear sRGB
representation before being written to the framebuffer attachment as
described in the “KHR_DF_TRANSFER_SRGB” section of the Khronos Data Format
Specification.</p><p>If the framebuffer color attachment numeric format is not sRGB encoded then
the resulting <span class="eq">c<sub>s</sub></span> values for R, G and B are unmodified.
The value of A is never sRGB encoded.
That is, the alpha component is always stored in memory as linear.</p><p>If the framebuffer color attachment is <code class="code">VK_ATTACHMENT_UNUSED</code>, no writes
are performed through that attachment.
Framebuffer color attachments greater than or equal to
<code class="code">VkSubpassDescription</code>::<em class="parameter"><code>colorAttachmentCount</code></em> perform no writes.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch26.html"><img src="images/icons/prev.png" alt="Prev" /></a> </td><td width="20%" align="center"><a accesskey="u" href="ch26.html"><img src="images/icons/up.png" alt="Up" /></a></td><td width="40%" align="right"> <a accesskey="n" href="ch26s02.html"><img src="images/icons/next.png" alt="Next" /></a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/icons/home.png" alt="Home" /></a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>