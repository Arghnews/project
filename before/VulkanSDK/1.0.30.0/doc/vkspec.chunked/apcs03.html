<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>C.3. VK_EXT_debug_marker</title><link rel="stylesheet" type="text/css" href="config/vkspec-xhtml.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="Vulkan 1.0.30 - A Specification (with WSI extensions)" /><link rel="up" href="apc.html" title="Appendix C. Layers &amp; Extensions" /><link rel="prev" href="apcs02.html" title="C.2. Window System Integration (WSI) Extensions" /><link rel="next" href="apcs04.html" title="C.4. VK_EXT_debug_report" /><script xmlns="" type="text/x-mathjax-config">
        MathJax.Hub.Config({
            MathML: { extensions: ["content-mathml.js"] },
            tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] }
        });
    </script><script xmlns="" type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="p" href="apcs02.html"><img src="images/icons/prev.png" alt="Prev" /></a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="apcs04.html"><img src="images/icons/next.png" alt="Next" /></a></td></tr></table><hr /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="VK_EXT_debug_marker"></a>C.3. VK_EXT_debug_marker</h2></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<span class="strong"><strong>Name String</strong></span>
</span></dt><dd>
    <code class="literal">VK_EXT_debug_marker</code>
</dd><dt><span class="term">
<span class="strong"><strong>Extension Type</strong></span>
</span></dt><dd>
    Device extension
</dd><dt><span class="term">
<span class="strong"><strong>Registered Extension Number</strong></span>
</span></dt><dd>
    23
</dd><dt><span class="term">
<span class="strong"><strong>Last Modified Date</strong></span>
</span></dt><dd>
    2016-04-23
</dd><dt><span class="term">
<span class="strong"><strong>Revision</strong></span>
</span></dt><dd>
    3
</dd><dt><span class="term">
<span class="strong"><strong>IP Status</strong></span>
</span></dt><dd>
    No known IP claims.
</dd><dt><span class="term">
<span class="strong"><strong>Dependencies</strong></span>
</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
This extension is written against version 1.0.11 of the Vulkan API.
</li></ul></div></dd><dt><span class="term">
<span class="strong"><strong>Contributors</strong></span>
</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
Baldur Karlsson
</li><li class="listitem">
Dan Ginsburg, Valve
</li><li class="listitem">
Jon Ashburn, LunarG
</li><li class="listitem">
Kyle Spagnoli, NVIDIA
</li></ul></div></dd><dt><span class="term">
<span class="strong"><strong>Contacts</strong></span>
</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
Baldur Karlsson
</li></ul></div></dd></dl></div><p>The <code class="literal">VK_EXT_debug_marker</code> extension is a device extension.
It introduces concepts of object naming and tagging, for better tracking of
Vulkan objects, as well as additional commands for recording annotations of
named sections of a workload to aid organisation and offline analysis in
external tools.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_new_object_types_11"></a>C.3.1. New Object Types</h3></div></div></div><p>None</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_new_enum_constants_12"></a>C.3.2. New Enum Constants</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p class="simpara">
Extending <code class="code"><a class="link" href="apds01.html#VkStructureType">VkStructureType</a></code>:
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<code class="code">VK_STRUCTURE_TYPE_DEBUG_MARKER_OBJECT_NAME_INFO_EXT</code>
</li><li class="listitem">
<code class="code">VK_STRUCTURE_TYPE_DEBUG_MARKER_OBJECT_TAG_INFO_EXT</code>
</li><li class="listitem">
<code class="code">VK_STRUCTURE_TYPE_DEBUG_MARKER_MARKER_INFO_EXT</code>
</li></ul></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_new_enums_11"></a>C.3.3. New Enums</h3></div></div></div><p>None</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_new_structures_11"></a>C.3.4. New Structures</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="code"><a class="link" href="ch32s01.html#VkDebugMarkerObjectNameInfoEXT">VkDebugMarkerObjectNameInfoEXT</a></code>
</li><li class="listitem">
<code class="code"><a class="link" href="ch32s01.html#VkDebugMarkerObjectTagInfoEXT">VkDebugMarkerObjectTagInfoEXT</a></code>
</li><li class="listitem">
<code class="code"><a class="link" href="ch32s01.html#VkDebugMarkerMarkerInfoEXT">VkDebugMarkerMarkerInfoEXT</a></code>
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_new_functions_11"></a>C.3.5. New Functions</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="code"><a class="link" href="ch32s01.html#vkDebugMarkerSetObjectTagEXT">vkDebugMarkerSetObjectTagEXT</a></code>
</li><li class="listitem">
<code class="code"><a class="link" href="ch32s01.html#vkDebugMarkerSetObjectNameEXT">vkDebugMarkerSetObjectNameEXT</a></code>
</li><li class="listitem">
<code class="code"><a class="link" href="ch32s01.html#vkCmdDebugMarkerBeginEXT">vkCmdDebugMarkerBeginEXT</a></code>
</li><li class="listitem">
<code class="code"><a class="link" href="ch32s01.html#vkCmdDebugMarkerEndEXT">vkCmdDebugMarkerEndEXT</a></code>
</li><li class="listitem">
<code class="code"><a class="link" href="ch32s01.html#vkCmdDebugMarkerInsertEXT">vkCmdDebugMarkerInsertEXT</a></code>
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_examples_5"></a>C.3.6. Examples</h3></div></div></div><p><span class="strong"><strong>Example 1</strong></span></p><p>Associate a name with an image, for easier debugging in external tools or
with validation layers that can print a friendly name when referring to
objects in error messages.</p><pre class="programlisting">    extern VkDevice device;
    extern VkImage image;

    // Must call extension functions through a function pointer:
    PFN_vkDebugMarkerSetObjectNameEXT pfnDebugMarkerSetObjectNameEXT = (PFN_vkDebugMarkerSetObjectNameEXT)vkGetDeviceProcAddr(device, "vkDebugMarkerSetObjectNameEXT");

    // Set a name on the image
    const VkDeviceCreateInfo imageNameInfo =
    {
        VK_STRUCTURE_TYPE_DEBUG_MARKER_OBJECT_NAME_INFO_EXT, // sType
        NULL,                                           // pNext
        VK_DEBUG_REPORT_OBJECT_TYPE_IMAGE_EXT,          // objectType
        (uint64_t)image,                                // object
        "Brick Diffuse Texture",                        // pObjectName
    };

    pfnDebugMarkerSetObjectNameEXT(device, &amp;imageNameInfo);

    // A subsequent error might print:
    //   Image 'Brick Diffuse Texture' (0xc0dec0dedeadbeef) is used in a
    //   command buffer with no memory bound to it.</pre><p><span class="strong"><strong>Example 2</strong></span></p><p>Annotating regions of a workload with naming information so that offline
analysis tools can display a more usable visualisation of the commands
submitted.</p><pre class="programlisting">    extern VkDevice device;
    extern VkCommandBuffer commandBuffer;

    // Must call extension functions through a function pointer:
    PFN_vkCmdDebugMarkerBeginEXT pfnCmdDebugMarkerBeginEXT = (PFN_vkCmdDebugMarkerBeginEXT)vkGetDeviceProcAddr(device, "vkCmdDebugMarkerBeginEXT");
    PFN_vkCmdDebugMarkerEndEXT pfnCmdDebugMarkerEndEXT = (PFN_vkCmdDebugMarkerEndEXT)vkGetDeviceProcAddr(device, "vkCmdDebugMarkerEndEXT");
    PFN_vkCmdDebugMarkerInsertEXT pfnCmdDebugMarkerInsertEXT = (PFN_vkCmdDebugMarkerInsertEXT)vkGetDeviceProcAddr(device, "vkCmdDebugMarkerInsertEXT");

    // Describe the area being rendered
    const VkDebugMarkerMarkerInfoEXT houseMarker =
    {
        VK_STRUCTURE_TYPE_DEBUG_MARKER_MARKER_INFO_EXT, // sType
        NULL,                                           // pNext
        "Brick House",                                  // pMarkerName
        { 1.0f, 0.0f, 0.0f, 1.0f },                     // color
    };

    // Start an annotated group of calls under the 'Brick House' name
    pfnCmdDebugMarkerBeginEXT(commandBuffer, &amp;houseMarker);
    {
        // A mutable structure for each part being rendered
        VkDebugMarkerMarkerInfoEXT housePartMarker =
        {
            VK_STRUCTURE_TYPE_DEBUG_MARKER_MARKER_INFO_EXT, // sType
            NULL,                                           // pNext
            NULL,                                           // pMarkerName
            { 0.0f, 0.0f, 0.0f, 0.0f },                     // color
        };

        // Set the name and insert the marker
        housePartMarker.pMarkerName = "Walls";
        pfnCmdDebugMarkerInsertEXT(commandBuffer, &amp;housePartMarker);

        // Insert the drawcall for the walls
        vkCmdDrawIndexed(commandBuffer, 1000, 1, 0, 0, 0);

        // Insert a recursive region for two sets of windows
        housePartMarker.pMarkerName = "Windows";
        pfnCmdDebugMarkerBeginEXT(commandBuffer, &amp;housePartMarker);
        {
            vkCmdDrawIndexed(commandBuffer, 75, 6, 1000, 0, 0);
            vkCmdDrawIndexed(commandBuffer, 100, 2, 1450, 0, 0);
        }
        pfnCmdDebugMarkerEndEXT(commandBuffer);

        housePartMarker.pMarkerName = "Front Door";
        pfnCmdDebugMarkerInsertEXT(commandBuffer, &amp;housePartMarker);

        vkCmdDrawIndexed(commandBuffer, 350, 1, 1650, 0, 0);

        housePartMarker.pMarkerName = "Roof";
        pfnCmdDebugMarkerInsertEXT(commandBuffer, &amp;housePartMarker);

        vkCmdDrawIndexed(commandBuffer, 500, 1, 2000, 0, 0);
    }
    // End the house annotation started above
    pfnCmdDebugMarkerEndEXT(commandBuffer);</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_issues_11"></a>C.3.7. Issues</h3></div></div></div><p>1) Should the tag or name for an object be specified using the pNext
   parameter in the object’s CreateInfo structure?</p><pre class="literallayout">RESOLVED: No.
While this fits with other Vulkan patterns and would allow more type
safety and future proofing against future objects, it has notable
downsides.
In particular passing the name at CreateInfo time does not allow
renaming, prevents late binding of naming information, and does not allow
naming of implicitly created objects such as queues and swap chain
images.</pre><p>2) Should the command annotation functions vkCmdDebugMarkerBeginEXT() and
   vkCmdDebugMarkerEndEXT() support the ability to specify a color?</p><pre class="literallayout">RESOLVED: Yes.
The functions have been expanded to take an optional color which can be
used at will by implementations consuming the command buffer annotations
in their visualisation.</pre><p>3) Should the functions added in this extension accept an extensible
   structure as their parameter for a more flexible API, as opposed to
   direct function parameters? If so, which functions?</p><pre class="literallayout">RESOLVED: Yes.
All functions have been modified to take a structure type with extensible
pNext pointer, to allow future extensions to add additional annotation
information in the same commands.</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_version_history_12"></a>C.3.8. Version History</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p class="simpara">
Revision 1, 2015-02-24 (Baldur Karlsson)
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
Initial draft, based on LunarG marker spec
</li></ul></div></li><li class="listitem"><p class="simpara">
Revision 2, 2015-02-26 (Baldur Karlsson)
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
Renamed Dbg to DebugMarker in function names
</li><li class="listitem">
Allow markers in secondary command buffers under certain circumstances
</li><li class="listitem">
Minor language tweaks and edits
</li></ul></div></li><li class="listitem"><p class="simpara">
Revision 3, 2015-04-23 (Baldur Karlsson)
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
Reorganise spec layout to closer match desired organisation
</li><li class="listitem">
Added optional color to markers (both regions and inserted labels)
</li><li class="listitem">
Changed functions to take extensible structs instead of direct function
     parameters
</li></ul></div></li></ul></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="apcs02.html"><img src="images/icons/prev.png" alt="Prev" /></a> </td><td width="20%" align="center"><a accesskey="u" href="apc.html"><img src="images/icons/up.png" alt="Up" /></a></td><td width="40%" align="right"> <a accesskey="n" href="apcs04.html"><img src="images/icons/next.png" alt="Next" /></a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/icons/home.png" alt="Home" /></a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>