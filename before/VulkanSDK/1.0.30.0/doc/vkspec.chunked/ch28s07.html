<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>28.7. Sparse Resource API</title><link rel="stylesheet" type="text/css" href="config/vkspec-xhtml.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="Vulkan 1.0.30 - A Specification (with WSI extensions)" /><link rel="up" href="ch28.html" title="Chapter 28. Sparse Resources" /><link rel="prev" href="ch28s06.html" title="28.6. Sparse Resource Implementation Guidelines" /><link rel="next" href="ch28s08.html" title="28.8. Examples" /><script xmlns="" type="text/x-mathjax-config">
        MathJax.Hub.Config({
            MathML: { extensions: ["content-mathml.js"] },
            tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] }
        });
    </script><script xmlns="" type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="p" href="ch28s06.html"><img src="images/icons/prev.png" alt="Prev" /></a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch28s08.html"><img src="images/icons/next.png" alt="Next" /></a></td></tr></table><hr /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="sparsememory-resourceapi"></a>28.7. Sparse Resource API</h2></div></div></div><p>The APIs related to sparse resources are grouped into the following
categories:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<a class="link" href="ch28s07.html#sparsememory-physicalfeatures" title="28.7.1. Physical Device Features">Physical Device Features</a>
</li><li class="listitem">
<a class="link" href="ch28s07.html#sparsememory-physicalprops" title="28.7.2. Physical Device Sparse Properties">Physical Device Sparse Properties</a>
</li><li class="listitem">
<a class="link" href="ch28s07.html#sparsememory-format-props" title="28.7.3. Sparse Image Format Properties">Sparse Image Format Properties</a>
</li><li class="listitem">
<a class="link" href="ch28s07.html#sparsememory-resource-creation" title="28.7.4. Sparse Resource Creation">Sparse Resource Creation</a>
</li><li class="listitem">
<a class="link" href="ch28s07.html#sparsememory-memory-requirements" title="28.7.5. Sparse Resource Memory Requirements">Sparse Resource Memory Requirements</a>
</li><li class="listitem">
<a class="link" href="ch28s07.html#sparsememory-resource-binding" title="28.7.6. Binding Resource Memory">Binding Resource Memory</a>
</li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sparsememory-physicalfeatures"></a>28.7.1. Physical Device Features</h3></div></div></div><p>Some sparse-resource related features are reported and enabled in
<code class="code">VkPhysicalDeviceFeatures</code>.
These features <span class="normative">must</span> be supported and enabled on the <code class="code">VkDevice</code> object
before applications <span class="normative">can</span> use them.
See <a class="link" href="ch31s01.html" title="31.1. Features">Physical Device Features</a> for information on how to
get and set enabled device features, and for more detailed explanations of
these features.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_sparse_physical_device_features"></a>Sparse Physical Device Features</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>sparseBinding</code></em>: Support for creating <code class="code">VkBuffer</code> and
    <code class="code">VkImage</code> objects with the <code class="code">VK_BUFFER_CREATE_SPARSE_BINDING_BIT</code>
    and <code class="code">VK_IMAGE_CREATE_SPARSE_BINDING_BIT</code> flags, respectively.
</li><li class="listitem">
<em class="parameter"><code>sparseResidencyBuffer</code></em>: Support for creating <code class="code">VkBuffer</code> objects
    with the <code class="code">VK_BUFFER_CREATE_SPARSE_RESIDENCY_BIT</code> flag.
</li><li class="listitem">
<em class="parameter"><code>sparseResidencyImage2D</code></em>: Support for creating 2D single-sampled
    <code class="code">VkImage</code> objects with <code class="code">VK_IMAGE_CREATE_SPARSE_RESIDENCY_BIT</code>.
</li><li class="listitem">
<em class="parameter"><code>sparseResidencyImage3D</code></em>: Support for creating 3D <code class="code">VkImage</code>
    objects with <code class="code">VK_IMAGE_CREATE_SPARSE_RESIDENCY_BIT</code>.
</li><li class="listitem">
<em class="parameter"><code>sparseResidency2Samples</code></em>: Support for creating 2D <code class="code">VkImage</code>
    objects with 2 samples and <code class="code">VK_IMAGE_CREATE_SPARSE_RESIDENCY_BIT</code>.
</li><li class="listitem">
<em class="parameter"><code>sparseResidency4Samples</code></em>: Support for creating 2D <code class="code">VkImage</code>
    objects with 4 samples and <code class="code">VK_IMAGE_CREATE_SPARSE_RESIDENCY_BIT</code>.
</li><li class="listitem">
<em class="parameter"><code>sparseResidency8Samples</code></em>: Support for creating 2D <code class="code">VkImage</code>
    objects with 8 samples and <code class="code">VK_IMAGE_CREATE_SPARSE_RESIDENCY_BIT</code>.
</li><li class="listitem">
<em class="parameter"><code>sparseResidency16Samples</code></em>: Support for creating 2D <code class="code">VkImage</code>
    objects with 16 samples and <code class="code">VK_IMAGE_CREATE_SPARSE_RESIDENCY_BIT</code>.
</li><li class="listitem">
<em class="parameter"><code>sparseResidencyAliased</code></em>: Support for creating <code class="code">VkBuffer</code> and
    <code class="code">VkImage</code> objects with the <code class="code">VK_BUFFER_CREATE_SPARSE_ALIASED_BIT</code>
    and <code class="code">VK_IMAGE_CREATE_SPARSE_ALIASED_BIT</code> flags, respectively.
</li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sparsememory-physicalprops"></a>28.7.2. Physical Device Sparse Properties</h3></div></div></div><p>Some features of the implementation are not possible to disable, and are
reported to allow applications to alter their sparse resource usage
accordingly.
These read-only capabilities are reported in the
<code class="code"><a class="link" href="ch04s01.html#VkPhysicalDeviceProperties">VkPhysicalDeviceProperties</a></code>::<em class="parameter"><code>sparseProperties</code></em> member, which is a
structure of type <code class="code">VkPhysicalDeviceSparseProperties</code>.</p><p>The <code class="code">VkPhysicalDeviceSparseProperties</code> structure is defined as:</p><p><a id="VkPhysicalDeviceSparseProperties"></a><strong> </strong>
</p><pre class="programlisting">typedef struct VkPhysicalDeviceSparseProperties {
    VkBool32    residencyStandard2DBlockShape;
    VkBool32    residencyStandard2DMultisampleBlockShape;
    VkBool32    residencyStandard3DBlockShape;
    VkBool32    residencyAlignedMipSize;
    VkBool32    residencyNonResidentStrict;
} VkPhysicalDeviceSparseProperties;</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>residencyStandard2DBlockShape</code></em> is <code class="code">VK_TRUE</code> if the physical
    device will access all single-sample 2D sparse resources using the
    standard sparse image block shapes (based on image format), as described
    in the <a class="link" href="ch28s04.html#sparsememory-sparseblockshapessingle" title="Table 28.1. Standard Sparse Image Block Shapes (Single Sample)">Standard Sparse Image     Block Shapes (Single Sample)</a> table.
    If this property is not supported the value returned in the
    <em class="parameter"><code>imageGranularity</code></em> member of the <code class="code">VkSparseImageFormatProperties</code>
    structure for single-sample 2D images is not <span class="normative">required</span> to match the
    standard sparse image block dimensions listed in the table.
</li><li class="listitem">
<em class="parameter"><code>residencyStandard2DMultisampleBlockShape</code></em> is <code class="code">VK_TRUE</code> if the
    physical device will access all multisample 2D sparse resources using
    the standard sparse image block shapes (based on image format), as
    described in the <a class="link" href="ch28s04.html#sparsememory-sparseblockshapesmsaa" title="Table 28.2. Standard Sparse Image Block Shapes (MSAA)">Standard Sparse     Image Block Shapes (MSAA)</a> table.
    If this property is not supported, the value returned in the
    <em class="parameter"><code>imageGranularity</code></em> member of the <code class="code">VkSparseImageFormatProperties</code>
    structure for multisample 2D images is not <span class="normative">required</span> to match the
    standard sparse image block dimensions listed in the table.
</li><li class="listitem">
<em class="parameter"><code>residencyStandard3DBlockShape</code></em> is <code class="code">VK_TRUE</code> if the physical
    device will access all 3D sparse resources using the standard sparse
    image block shapes (based on image format), as described in the
    <a class="link" href="ch28s04.html#sparsememory-sparseblockshapessingle" title="Table 28.1. Standard Sparse Image Block Shapes (Single Sample)">Standard Sparse Image Block     Shapes (Single Sample)</a> table.
    If this property is not supported, the value returned in the
    <em class="parameter"><code>imageGranularity</code></em> member of the <code class="code">VkSparseImageFormatProperties</code>
    structure for 3D images is not <span class="normative">required</span> to match the standard sparse
    image block dimensions listed in the table.
</li><li class="listitem">
<em class="parameter"><code>residencyAlignedMipSize</code></em> is <code class="code">VK_TRUE</code> if images with mip level
    dimensions that are not integer multiples of the corresponding
    dimensions of the sparse image block <span class="normative">may</span> be placed in the mip tail.
    If this property is not reported, only mip levels with dimensions
    smaller than the <em class="parameter"><code>imageGranularity</code></em> member of the
    <code class="code">VkSparseImageFormatProperties</code> structure will be placed in the mip
    tail.
    If this property is reported the implementation is allowed to return
    <code class="code">VK_SPARSE_IMAGE_FORMAT_ALIGNED_MIP_SIZE_BIT</code> in the <em class="parameter"><code>flags</code></em>
    member of <code class="code">VkSparseImageFormatProperties</code>, indicating that mip level
    dimensions that are not integer multiples of the corresponding
    dimensions of the sparse image block will be placed in the mip tail.
</li><li class="listitem">
<em class="parameter"><code>residencyNonResidentStrict</code></em> specifies whether the physical device
    <span class="normative">can</span> consistently access non-resident regions of a resource.
    If this property is <code class="code">VK_TRUE</code>, access to non-resident regions of
    resources will be guaranteed to return values as if the resource were
    populated with 0; writes to non-resident regions will be discarded.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sparsememory-format-props"></a>28.7.3. Sparse Image Format Properties</h3></div></div></div><p>Given that certain aspects of sparse image support, including the sparse
image block dimensions, <span class="normative">may</span> be implementation-dependent,
<code class="code"><a class="link" href="ch28s07.html#vkGetPhysicalDeviceSparseImageFormatProperties">vkGetPhysicalDeviceSparseImageFormatProperties</a></code> <span class="normative">can</span> be used to query
for sparse image format properties prior to resource creation.
This command is used to check whether a given set of sparse image parameters
is supported and what the sparse image block shape will be.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_sparse_image_format_properties_api"></a>Sparse Image Format Properties API</h4></div></div></div><p>The <code class="code">VkSparseImageFormatProperties</code> structure is defined as:</p><p><a id="VkSparseImageFormatProperties"></a><strong> </strong>
</p><pre class="programlisting">typedef struct VkSparseImageFormatProperties {
    VkImageAspectFlags          aspectMask;
    VkExtent3D                  imageGranularity;
    VkSparseImageFormatFlags    flags;
} VkSparseImageFormatProperties;</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>aspectMask</code></em> is a bitmask of <code class="code"><a class="link" href="ch11s05.html#VkImageAspectFlagBits">VkImageAspectFlagBits</a></code> specifying
    which aspects of the image the properties apply to.
</li><li class="listitem">
<em class="parameter"><code>imageGranularity</code></em> is the width, height, and depth of the sparse
    image block in texels or compressed texel blocks.
</li><li class="listitem"><p class="simpara">
<em class="parameter"><code>flags</code></em> is a bitmask specifying additional information about the
    sparse resource.
    Bits which <span class="normative">can</span> be set include:
</p><p><a id="VkSparseImageFormatFlagBits"></a><strong> </strong>
</p><pre class="programlisting">typedef enum VkSparseImageFormatFlagBits {
    VK_SPARSE_IMAGE_FORMAT_SINGLE_MIPTAIL_BIT = 0x00000001,
    VK_SPARSE_IMAGE_FORMAT_ALIGNED_MIP_SIZE_BIT = 0x00000002,
    VK_SPARSE_IMAGE_FORMAT_NONSTANDARD_BLOCK_SIZE_BIT = 0x00000004,
} VkSparseImageFormatFlagBits;</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
If <code class="code">VK_SPARSE_IMAGE_FORMAT_SINGLE_MIPTAIL_BIT</code> is set, the image
     uses a single mip tail region for all array layers.
</li><li class="listitem">
If <code class="code">VK_SPARSE_IMAGE_FORMAT_ALIGNED_MIP_SIZE_BIT</code> is set, the first
     mip level whose dimensions are not integer multiples of the
     corresponding dimensions of the sparse image block begins the mip tail
     region.
</li><li class="listitem">
If <code class="code">VK_SPARSE_IMAGE_FORMAT_NONSTANDARD_BLOCK_SIZE_BIT</code> is set, the
     image uses non-standard sparse image block dimensions, and the
     <em class="parameter"><code>imageGranularity</code></em> values do not match the standard sparse image
     block dimensions for the given pixel format.
</li></ul></div></li></ul></div><p><span class="strong"><strong><code class="code">vkGetPhysicalDeviceSparseImageFormatProperties</code></strong></span> returns an array of
<code class="code"><a class="link" href="ch28s07.html#VkSparseImageFormatProperties">VkSparseImageFormatProperties</a></code>.
Each element will describe properties for one set of image aspects that are
bound simultaneously in the image.
This is usually one element for each aspect in the image, but for
interleaved depth/stencil images there is only one element describing the
combined aspects.</p><p><a id="vkGetPhysicalDeviceSparseImageFormatProperties"></a><strong> </strong>
</p><pre class="programlisting">void vkGetPhysicalDeviceSparseImageFormatProperties(
    VkPhysicalDevice                            physicalDevice,
    VkFormat                                    format,
    VkImageType                                 type,
    VkSampleCountFlagBits                       samples,
    VkImageUsageFlags                           usage,
    VkImageTiling                               tiling,
    uint32_t*                                   pPropertyCount,
    VkSparseImageFormatProperties*              pProperties);</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>physicalDevice</code></em> is the physical device from which to query the
    sparse image capabilities.
</li><li class="listitem">
<em class="parameter"><code>format</code></em> is the image format.
</li><li class="listitem">
<em class="parameter"><code>type</code></em> is the dimensionality of image.
</li><li class="listitem">
<em class="parameter"><code>samples</code></em> is the number of samples per pixel as defined in
    <code class="code"><a class="link" href="ch31s02.html#VkSampleCountFlagBits">VkSampleCountFlagBits</a></code>.
</li><li class="listitem">
<em class="parameter"><code>usage</code></em> is a bitmask describing the intended usage of the image.
</li><li class="listitem">
<em class="parameter"><code>tiling</code></em> is the tiling arrangement of the data elements in memory.
</li><li class="listitem">
<em class="parameter"><code>pPropertyCount</code></em> is a pointer to an integer related to the number of
    sparse format properties available or queried, as described below.
</li><li class="listitem">
<em class="parameter"><code>pProperties</code></em> is either <code class="literal">NULL</code> or a pointer to an array of
    <code class="code"><a class="link" href="ch28s07.html#VkSparseImageFormatProperties">VkSparseImageFormatProperties</a></code> structures.
</li></ul></div><p>If <em class="parameter"><code>pProperties</code></em> is <code class="literal">NULL</code>, then the number of sparse format properties
available is returned in <em class="parameter"><code>pPropertyCount</code></em>.
Otherwise, <em class="parameter"><code>pPropertyCount</code></em> <span class="normative">must</span> point to a variable set by the user to
the number of elements in the <em class="parameter"><code>pProperties</code></em> array, and on return the
variable is overwritten with the number of structures actually written to
<em class="parameter"><code>pProperties</code></em>.
If <em class="parameter"><code>pPropertyCount</code></em> is less than the number of sparse format properties
available, at most <em class="parameter"><code>pPropertyCount</code></em> structures will be written.</p><p>If <code class="code">VK_IMAGE_CREATE_SPARSE_RESIDENCY_BIT</code> is not supported for the given
arguments, <em class="parameter"><code>pPropertyCount</code></em> will be set to zero upon return, and no data
will be written to <em class="parameter"><code>pProperties</code></em>.</p><p>Multiple aspects are returned for depth/stencil images that are implemented
as separate planes by the implementation.
The depth and stencil data planes each have unique
<code class="code">VkSparseImageFormatProperties</code> data.</p><p>Depth/stencil images with depth and stencil data interleaved into a single
plane will return a single <code class="code">VkSparseImageFormatProperties</code> structure
with the <em class="parameter"><code>aspectMask</code></em> set to <code class="code">VK_IMAGE_ASPECT_DEPTH_BIT</code> |
<code class="code">VK_IMAGE_ASPECT_STENCIL_BIT</code>.</p><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>samples</code></em> <span class="normative">must</span> be a bit value that is set in
    <code class="code">VkImageFormatProperties</code>::<em class="parameter"><code>sampleCounts</code></em> returned by
    <span class="strong"><strong><code class="code">vkGetPhysicalDeviceImageFormatProperties</code></strong></span> with <em class="parameter"><code>format</code></em>,
    <em class="parameter"><code>type</code></em>, <em class="parameter"><code>tiling</code></em>, and <em class="parameter"><code>usage</code></em> equal to those in this command
    and <em class="parameter"><code>flags</code></em> equal to the value that is set in
    <code class="code">VkImageCreateInfo</code>::<em class="parameter"><code>flags</code></em> when the image is created
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>physicalDevice</code></em> <span class="normative">must</span> be a valid <code class="code">VkPhysicalDevice</code> handle
</li><li class="listitem">
<em class="parameter"><code>format</code></em> <span class="normative">must</span> be a valid <code class="code"><a class="link" href="ch31s03.html#VkFormat">VkFormat</a></code> value
</li><li class="listitem">
<em class="parameter"><code>type</code></em> <span class="normative">must</span> be a valid <code class="code"><a class="link" href="ch11s03.html#VkImageType">VkImageType</a></code> value
</li><li class="listitem">
<em class="parameter"><code>samples</code></em> <span class="normative">must</span> be a valid <code class="code"><a class="link" href="ch31s02.html#VkSampleCountFlagBits">VkSampleCountFlagBits</a></code> value
</li><li class="listitem">
<em class="parameter"><code>usage</code></em> <span class="normative">must</span> be a valid combination of <code class="code"><a class="link" href="ch11s03.html#VkImageUsageFlagBits">VkImageUsageFlagBits</a></code> values
</li><li class="listitem">
<em class="parameter"><code>usage</code></em> <span class="normative">must</span> not be <code class="literal">0</code>
</li><li class="listitem">
<em class="parameter"><code>tiling</code></em> <span class="normative">must</span> be a valid <code class="code"><a class="link" href="ch11s03.html#VkImageTiling">VkImageTiling</a></code> value
</li><li class="listitem">
<em class="parameter"><code>pPropertyCount</code></em> <span class="normative">must</span> be a pointer to a <code class="code">uint32_t</code> value
</li><li class="listitem">
If the value referenced by <em class="parameter"><code>pPropertyCount</code></em> is not <code class="literal">0</code>, and <em class="parameter"><code>pProperties</code></em> is not <code class="literal">NULL</code>, <em class="parameter"><code>pProperties</code></em> <span class="normative">must</span> be a pointer to an array of <em class="parameter"><code>pPropertyCount</code></em> <code class="code">VkSparseImageFormatProperties</code> structures
</li></ul></div></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sparsememory-resource-creation"></a>28.7.4. Sparse Resource Creation</h3></div></div></div><p>Sparse resources require that one or more sparse feature flags be specified
(as part of the <code class="code">VkPhysicalDeviceFeatures</code> structure described
previously in the <a class="link" href="ch28s07.html#sparsememory-physicalfeatures" title="28.7.1. Physical Device Features">Physical Device Features</a>
section) at CreateDevice time.
When the appropriate device features are enabled, the
<code class="code">VK_BUFFER_CREATE_SPARSE_*</code> and <code class="code">VK_IMAGE_CREATE_SPARSE_*</code> flags
<span class="normative">can</span> be used.
See <code class="code"><a class="link" href="ch11s01.html#vkCreateBuffer">vkCreateBuffer</a></code> and <code class="code"><a class="link" href="ch11s03.html#vkCreateImage">vkCreateImage</a></code> for details of the resource
creation APIs.</p><div class="note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note: Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/icons/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Specifying <code class="code">VK_BUFFER_CREATE_SPARSE_RESIDENCY_BIT</code> or
<code class="code">VK_IMAGE_CREATE_SPARSE_RESIDENCY_BIT</code> requires specifying
<code class="code">VK_BUFFER_CREATE_SPARSE_BINDING_BIT</code> or
<code class="code">VK_IMAGE_CREATE_SPARSE_BINDING_BIT</code>, respectively, as well.
This means that resources <span class="normative">must</span> be created with the appropriate
<code class="code">*_SPARSE_BINDING_BIT</code> to be used with the sparse binding command
(<span class="strong"><strong><code class="code">vkQueueBindSparse</code></strong></span>).</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sparsememory-memory-requirements"></a>28.7.5. Sparse Resource Memory Requirements</h3></div></div></div><p>Sparse resources have specific memory requirements related to binding sparse
memory.
These memory requirements are reported differently for <code class="code">VkBuffer</code>
objects and <code class="code">VkImage</code> objects.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="sparsememory-memory-buffer-fully-resident"></a>Buffer and Fully-Resident Images</h4></div></div></div><p>Buffers (both fully and partially resident) and fully-resident images <span class="normative">can</span>
be bound to memory using only the data from <code class="code">VkMemoryRequirements</code>.
For all sparse resources the <code class="code">VkMemoryRequirements</code>::<em class="parameter"><code>alignment</code></em>
member denotes both the bindable sparse block size in bytes and <span class="normative">required</span>
alignment of <code class="code">VkDeviceMemory</code>.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="sparsememory-memory-partially-resident"></a>Partially Resident Images</h4></div></div></div><p>Partially resident images have a different method for binding memory.
As with buffers and fully resident images, the
<code class="code">VkMemoryRequirements</code>::<em class="parameter"><code>alignment</code></em> field denotes the bindable
sparse block size in bytes for the image.</p><p>Requesting sparse memory requirements for <code class="code">VkImage</code> objects using
<span class="strong"><strong><code class="code">vkGetImageSparseMemoryRequirements</code></strong></span> will return an array of one or more
<code class="code">VkSparseImageMemoryRequirements</code> structures.
Each structure describes the sparse memory requirements for a group of
aspects of the image.</p><p>The sparse image <span class="normative">must</span> have been created using the
<code class="code">VK_IMAGE_CREATE_SPARSE_RESIDENCY_BIT</code> flag to retrieve valid sparse
image memory requirements.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_sparse_image_memory_requirements"></a>Sparse Image Memory Requirements</h4></div></div></div><p>The <code class="code">VkSparseImageMemoryRequirements</code> structure is defined as:</p><p><a id="VkSparseImageMemoryRequirements"></a><strong> </strong>
</p><pre class="programlisting">typedef struct VkSparseImageMemoryRequirements {
    VkSparseImageFormatProperties    formatProperties;
    uint32_t                         imageMipTailFirstLod;
    VkDeviceSize                     imageMipTailSize;
    VkDeviceSize                     imageMipTailOffset;
    VkDeviceSize                     imageMipTailStride;
} VkSparseImageMemoryRequirements;</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>formatProperties.aspectMask</code></em> is the set of aspects of the image
    that this sparse memory requirement applies to.
    This will usually have a single aspect specified.
    However, depth/stencil images <span class="normative">may</span> have depth and stencil data
    interleaved in the same sparse block, in which case both
    <code class="code">VK_IMAGE_ASPECT_DEPTH_BIT</code> and <code class="code">VK_IMAGE_ASPECT_STENCIL_BIT</code>
    would be present.
</li><li class="listitem">
<em class="parameter"><code>formatProperties.imageGranularity</code></em> describes the dimensions of a
    single bindable sparse image block in pixel units.
    For aspect <code class="code">VK_IMAGE_ASPECT_METADATA_BIT</code>, all dimensions will be
    zero pixels.
    All metadata is located in the mip tail region.
</li><li class="listitem"><p class="simpara">
<em class="parameter"><code>formatProperties.flags</code></em> is a bitmask of
    <code class="code"><a class="link" href="ch28s07.html#VkSparseImageFormatFlagBits">VkSparseImageFormatFlagBits</a></code>:
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
If <code class="code">VK_SPARSE_IMAGE_FORMAT_SINGLE_MIPTAIL_BIT</code> is set the image
     uses a single mip tail region for all array layers.
</li><li class="listitem">
If <code class="code">VK_SPARSE_IMAGE_FORMAT_ALIGNED_MIP_SIZE_BIT</code> is set the
     dimensions of mip levels <span class="normative">must</span> be integer multiples of the
     corresponding dimensions of the sparse image block for levels not
     located in the mip tail.
</li><li class="listitem">
If <code class="code">VK_SPARSE_IMAGE_FORMAT_NONSTANDARD_BLOCK_SIZE_BIT</code> is set the
     image uses non-standard sparse image block dimensions.
     The <em class="parameter"><code>formatProperties.imageGranularity</code></em> values do not match the
     standard sparse image block dimension corresponding to the image’s
     pixel format.
</li></ul></div></li><li class="listitem">
<em class="parameter"><code>imageMipTailFirstLod</code></em> is the first mip level at which image
    subresources are included in the mip tail region.
</li><li class="listitem">
<em class="parameter"><code>imageMipTailSize</code></em> is the memory size (in bytes) of the mip tail
    region.
    If <em class="parameter"><code>formatProperties.flags</code></em> contains
    <code class="code">VK_SPARSE_IMAGE_FORMAT_SINGLE_MIPTAIL_BIT</code>, this is the size of the
    whole mip tail, otherwise this is the size of the mip tail of a single
    array layer.
    This value is guaranteed to be a multiple of the sparse block size in
    bytes.
</li><li class="listitem">
<em class="parameter"><code>imageMipTailOffset</code></em> is the opaque memory offset used with
    <code class="code"><a class="link" href="ch28s07.html#VkSparseImageOpaqueMemoryBindInfo">VkSparseImageOpaqueMemoryBindInfo</a></code> to bind the mip tail region(s).
</li><li class="listitem">
<em class="parameter"><code>imageMipTailStride</code></em> is the offset stride between each array-layer’s
    mip tail, if <em class="parameter"><code>formatProperties.flags</code></em> does not contain
    <code class="code">VK_SPARSE_IMAGE_FORMAT_SINGLE_MIPTAIL_BIT</code> (otherwise the value is
    undefined).
</li></ul></div><p>To query sparse memory requirements for an image, call:</p><p><a id="vkGetImageSparseMemoryRequirements"></a><strong> </strong>
</p><pre class="programlisting">void vkGetImageSparseMemoryRequirements(
    VkDevice                                    device,
    VkImage                                     image,
    uint32_t*                                   pSparseMemoryRequirementCount,
    VkSparseImageMemoryRequirements*            pSparseMemoryRequirements);</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>device</code></em> is the logical device that owns the image.
</li><li class="listitem">
<em class="parameter"><code>image</code></em> is the <code class="code">VkImage</code> object to get the memory requirements
    for.
</li><li class="listitem">
<em class="parameter"><code>pSparseMemoryRequirementCount</code></em> is a pointer to an integer related
    to the number of sparse memory requirements available or queried, as
    described below.
</li><li class="listitem">
<em class="parameter"><code>pSparseMemoryRequirements</code></em> is either <code class="literal">NULL</code> or a pointer to an
    array of <code class="code">VkSparseImageMemoryRequirements</code> structures.
</li></ul></div><p>If <em class="parameter"><code>pSparseMemoryRequirements</code></em> is <code class="literal">NULL</code>, then the number of sparse
memory requirements available is returned in
<em class="parameter"><code>pSparseMemoryRequirementCount</code></em>.
Otherwise, <em class="parameter"><code>pSparseMemoryRequirementCount</code></em> <span class="normative">must</span> point to a variable set
by the user to the number of elements in the <em class="parameter"><code>pSparseMemoryRequirements</code></em>
array, and on return the variable is overwritten with the number of
structures actually written to <em class="parameter"><code>pSparseMemoryRequirements</code></em>.
If <em class="parameter"><code>pSparseMemoryRequirementCount</code></em> is less than the number of sparse
memory requirements available, at most <em class="parameter"><code>pSparseMemoryRequirementCount</code></em>
structures will be written.</p><p>If the image was not created with <code class="code">VK_IMAGE_CREATE_SPARSE_RESIDENCY_BIT</code>
then <em class="parameter"><code>pSparseMemoryRequirementCount</code></em> will be set to zero and
<em class="parameter"><code>pSparseMemoryRequirements</code></em> will not be written to.</p><div class="note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note: Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/icons/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>It is legal for an implementation to report a larger value in
<code class="code">VkMemoryRequirements</code>::<em class="parameter"><code>size</code></em> than would be obtained by adding
together memory sizes for all <code class="code">VkSparseImageMemoryRequirements</code> returned
by <span class="strong"><strong><code class="code">vkGetImageSparseMemoryRequirements</code></strong></span>.
This <span class="normative">may</span> occur when the hardware requires unused padding in the address
range describing the resource.</p></td></tr></table></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>device</code></em> <span class="normative">must</span> be a valid <code class="code">VkDevice</code> handle
</li><li class="listitem">
<em class="parameter"><code>image</code></em> <span class="normative">must</span> be a valid <code class="code">VkImage</code> handle
</li><li class="listitem">
<em class="parameter"><code>pSparseMemoryRequirementCount</code></em> <span class="normative">must</span> be a pointer to a <code class="code">uint32_t</code> value
</li><li class="listitem">
If the value referenced by <em class="parameter"><code>pSparseMemoryRequirementCount</code></em> is not <code class="literal">0</code>, and <em class="parameter"><code>pSparseMemoryRequirements</code></em> is not <code class="literal">NULL</code>, <em class="parameter"><code>pSparseMemoryRequirements</code></em> <span class="normative">must</span> be a pointer to an array of <em class="parameter"><code>pSparseMemoryRequirementCount</code></em> <code class="code">VkSparseImageMemoryRequirements</code> structures
</li><li class="listitem">
<em class="parameter"><code>image</code></em> <span class="normative">must</span> have been created, allocated, or retrieved from <em class="parameter"><code>device</code></em>
</li></ul></div></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sparsememory-resource-binding"></a>28.7.6. Binding Resource Memory</h3></div></div></div><p>Non-sparse resources are backed by a single physical allocation prior to
device use (via <span class="strong"><strong><code class="code">vkBindImageMemory</code></strong></span> or <span class="strong"><strong><code class="code">vkBindBufferMemory</code></strong></span>), and
their backing <span class="normative">must</span> not be changed.
On the other hand, sparse resources <span class="normative">can</span> be bound to memory non-contiguously
and these bindings <span class="normative">can</span> be altered during the lifetime of the resource.</p><div class="note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note: Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/icons/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>It is important to note that freeing a <code class="code">VkDeviceMemory</code> object with
<span class="strong"><strong><code class="code">vkFreeMemory</code></strong></span> will not cause resources (or resource regions) bound to
the memory object to become unbound.
Access to resources that are bound to memory objects that have been freed
will result in undefined behavior, potentially including application
termination.</p><p>Implementations <span class="normative">must</span> ensure that no access to physical memory owned by the
system or another process will occur in this scenario.
In other words, accessing resources bound to freed memory <span class="normative">may</span> result in
application termination, but <span class="normative">must</span> not result in system termination or in
reading non-process-accessible memory.</p></td></tr></table></div><p>Sparse memory bindings execute on a queue that includes the
<code class="code">VK_QUEUE_SPARSE_BINDING_BIT</code> bit.
Applications <span class="normative">must</span> use <a class="link" href="ch06.html" title="Chapter 6. Synchronization and Cache Control">synchronization primitives</a> to
guarantee that other queues do not access ranges of memory concurrently with
a binding change.
Accessing memory in a range while it is being rebound results in undefined
behavior.
It is valid to access other ranges of the same resource while a bind
operation is executing.</p><div class="note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note: Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/icons/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Implementations <span class="normative">must</span> provide a guarantee that simultaneously binding sparse
blocks while another queue accesses those same sparse blocks via a sparse
resource <span class="normative">must</span> not access memory owned by another process or otherwise
corrupt the system.</p></td></tr></table></div><p>While some implementations <span class="normative">may</span> include <code class="code">VK_QUEUE_SPARSE_BINDING_BIT</code>
support in queue families that also include graphics and compute support,
other implementations <span class="normative">may</span> only expose a
<code class="code">VK_QUEUE_SPARSE_BINDING_BIT</code>-only queue family.
In either case, applications <span class="normative">must</span> use <a class="link" href="ch06.html" title="Chapter 6. Synchronization and Cache Control">synchronization primitives</a> to explicitly request any ordering dependencies between sparse
memory binding operations and other graphics/compute/transfer operations, as
sparse binding operations are not automatically ordered against command
buffer execution, even within a single queue.</p><p>When binding memory explicitly for the <code class="code">VK_IMAGE_ASPECT_METADATA_BIT</code>
the application <span class="normative">must</span> use the <code class="code">VK_SPARSE_MEMORY_BIND_METADATA_BIT</code> in
the <code class="code">VkSparseMemoryBind</code>::<em class="parameter"><code>flags</code></em> field when binding memory.
Binding memory for metadata is done the same way as binding memory for the
mip tail, with the addition of the <code class="code">VK_SPARSE_MEMORY_BIND_METADATA_BIT</code>
flag.</p><p>Binding the mip tail for any aspect <span class="normative">must</span> only be performed using
<code class="code"><a class="link" href="ch28s07.html#VkSparseImageOpaqueMemoryBindInfo">VkSparseImageOpaqueMemoryBindInfo</a></code>.
If <em class="parameter"><code>formatProperties.flags</code></em> contains
<code class="code">VK_SPARSE_IMAGE_FORMAT_SINGLE_MIPTAIL_BIT</code>, then it <span class="normative">can</span> be bound with
a single <code class="code"><a class="link" href="ch28s07.html#VkSparseMemoryBind">VkSparseMemoryBind</a></code> structure, with <em class="parameter"><code>resourceOffset</code></em> =
<em class="parameter"><code>imageMipTailOffset</code></em> and <em class="parameter"><code>size</code></em> = <em class="parameter"><code>imageMipTailSize</code></em>.</p><p>If <em class="parameter"><code>formatProperties.flags</code></em> does not contain
<code class="code">VK_SPARSE_IMAGE_FORMAT_SINGLE_MIPTAIL_BIT</code> then the offset for the mip
tail in each array layer is given as:</p><pre class="programlisting">arrayMipTailOffset = imageMipTailOffset + arrayLayer * imageMipTailStride;</pre><p>and the mip tail <span class="normative">can</span> be bound with <span class="strong"><strong><code class="code">layerCount</code></strong></span> <code class="code"><a class="link" href="ch28s07.html#VkSparseMemoryBind">VkSparseMemoryBind</a></code>
structures, each using <em class="parameter"><code>size</code></em> = <em class="parameter"><code>imageMipTailSize</code></em> and
<em class="parameter"><code>resourceOffset</code></em> = <em class="parameter"><code>arrayMipTailOffset</code></em> as defined above.</p><p>Sparse memory binding is handled by the following APIs and related data
structures.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="sparsemem-memory-binding"></a>Sparse Memory Binding Functions</h4></div></div></div><p>The <code class="code">VkSparseMemoryBind</code> structure is defined as:</p><p><a id="VkSparseMemoryBind"></a><strong> </strong>
</p><pre class="programlisting">typedef struct VkSparseMemoryBind {
    VkDeviceSize               resourceOffset;
    VkDeviceSize               size;
    VkDeviceMemory             memory;
    VkDeviceSize               memoryOffset;
    VkSparseMemoryBindFlags    flags;
} VkSparseMemoryBind;</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>resourceOffset</code></em> is the offset into the resource.
</li><li class="listitem">
<em class="parameter"><code>size</code></em> is the size of the memory region to be bound.
</li><li class="listitem">
<em class="parameter"><code>memory</code></em> is the <code class="code">VkDeviceMemory</code> object that the range of the
    resource is bound to.
    If <em class="parameter"><code>memory</code></em> is <code class="code"><a class="link" href="apds03.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></code>, the range is unbound.
</li><li class="listitem">
<em class="parameter"><code>memoryOffset</code></em> is the offset into the <code class="code">VkDeviceMemory</code> object to
    bind the resource range to.
    If <em class="parameter"><code>memory</code></em> is <code class="code"><a class="link" href="apds03.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></code>, this value is ignored.
</li><li class="listitem"><p class="simpara">
<em class="parameter"><code>flags</code></em> is a bitmask specifying usage of the binding operation.
    Bits which <span class="normative">can</span> be set include:
</p><p><a id="VkSparseMemoryBindFlagBits"></a><strong> </strong>
</p><pre class="programlisting">typedef enum VkSparseMemoryBindFlagBits {
    VK_SPARSE_MEMORY_BIND_METADATA_BIT = 0x00000001,
} VkSparseMemoryBindFlagBits;</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<code class="code">VK_SPARSE_MEMORY_BIND_METADATA_BIT</code> indicates that the memory
     being bound is only for the metadata aspect.
</li></ul></div></li></ul></div><p>The <span class="emphasis"><em>binding range</em></span> <span class="eq">[<em class="parameter"><code>resourceOffset</code></em>, <em class="parameter"><code>resourceOffset</code></em> +
<em class="parameter"><code>size</code></em>)</span> has different constraints based on <em class="parameter"><code>flags</code></em>.
If <em class="parameter"><code>flags</code></em> contains <code class="code">VK_SPARSE_MEMORY_BIND_METADATA_BIT</code>, the
binding range <span class="normative">must</span> be within the mip tail region of the metadata aspect.
This metadata region is defined by:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
 
</span></dt><dd>
<span class="eq">metadataRegion = [base, base + <em class="parameter"><code>imageMipTailSize</code></em>)</span>
</dd><dt><span class="term">
 
</span></dt><dd>
<span class="eq">base = <em class="parameter"><code>imageMipTailOffset</code></em> + <em class="parameter"><code>imageMipTailStride</code></em> ×
     n</span>
</dd></dl></div><p>and <em class="parameter"><code>imageMipTailOffset</code></em>, <em class="parameter"><code>imageMipTailSize</code></em>, and
<em class="parameter"><code>imageMipTailStride</code></em> values are from the
<code class="code"><a class="link" href="ch28s07.html#VkSparseImageMemoryRequirements">VkSparseImageMemoryRequirements</a></code> corresponding to the metadata aspect
of the image, and <span class="eq">n</span> is a valid array layer index for the image,</p><p><em class="parameter"><code>imageMipTailStride</code></em> is considered to be zero for aspects where
<code class="code">VkSparseImageMemoryRequirements</code>::<em class="parameter"><code>formatProperties.flags</code></em> contains
<code class="code">VK_SPARSE_IMAGE_FORMAT_SINGLE_MIPTAIL_BIT</code>.</p><p>If <em class="parameter"><code>flags</code></em> does not contain <code class="code">VK_SPARSE_MEMORY_BIND_METADATA_BIT</code>,
the binding range <span class="normative">must</span> be within the range
<span class="eq">[0,<code class="code"><a class="link" href="ch11s06.html#VkMemoryRequirements">VkMemoryRequirements</a></code>::<em class="parameter"><code>size</code></em>)</span>.</p><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
If <em class="parameter"><code>memory</code></em> is not <code class="code"><a class="link" href="apds03.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></code>, <em class="parameter"><code>memory</code></em> and
    <em class="parameter"><code>memoryOffset</code></em> <span class="normative">must</span> match the memory requirements of the resource,
    as described in section <a class="xref" href="ch11s06.html" title="11.6. Resource Memory Association">Section 11.6, “Resource Memory Association”</a>
</li><li class="listitem">
If <em class="parameter"><code>memory</code></em> is not <code class="code"><a class="link" href="apds03.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></code>, <em class="parameter"><code>memory</code></em> <span class="normative">must</span> not have
    been created with a memory type that reports
    <code class="code">VK_MEMORY_PROPERTY_LAZILY_ALLOCATED_BIT</code> bit set
</li><li class="listitem">
<em class="parameter"><code>size</code></em> <span class="normative">must</span> be greater than <code class="literal">0</code>
</li><li class="listitem">
<em class="parameter"><code>resourceOffset</code></em> <span class="normative">must</span> be less than the size of the resource
</li><li class="listitem">
<em class="parameter"><code>size</code></em> <span class="normative">must</span> be less than or equal to the size of the resource minus
    <em class="parameter"><code>resourceOffset</code></em>
</li><li class="listitem">
<em class="parameter"><code>memoryOffset</code></em> <span class="normative">must</span> be less than the size of <em class="parameter"><code>memory</code></em>
</li><li class="listitem">
<em class="parameter"><code>size</code></em> <span class="normative">must</span> be less than or equal to the size of <em class="parameter"><code>memory</code></em> minus
    <em class="parameter"><code>memoryOffset</code></em>
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
If <em class="parameter"><code>memory</code></em> is not <code class="code"><a class="link" href="apds03.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></code>, <em class="parameter"><code>memory</code></em> <span class="normative">must</span> be a valid <code class="code">VkDeviceMemory</code> handle
</li><li class="listitem">
<em class="parameter"><code>flags</code></em> <span class="normative">must</span> be a valid combination of <code class="code"><a class="link" href="ch28s07.html#VkSparseMemoryBindFlagBits">VkSparseMemoryBindFlagBits</a></code> values
</li></ul></div></div><p>Memory is bound to <code class="code">VkBuffer</code> objects created with the
<code class="code">VK_BUFFER_CREATE_SPARSE_BINDING_BIT</code> flag using the following
structure:</p><p><a id="VkSparseBufferMemoryBindInfo"></a><strong> </strong>
</p><pre class="programlisting">typedef struct VkSparseBufferMemoryBindInfo {
    VkBuffer                     buffer;
    uint32_t                     bindCount;
    const VkSparseMemoryBind*    pBinds;
} VkSparseBufferMemoryBindInfo;</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>buffer</code></em> is the <code class="code">VkBuffer</code> object to be bound.
</li><li class="listitem">
<em class="parameter"><code>bindCount</code></em> is the number of <code class="code">VkSparseMemoryBind</code> structures in
    the <em class="parameter"><code>pBinds</code></em> array.
</li><li class="listitem">
<em class="parameter"><code>pBinds</code></em> is a pointer to array of <code class="code">VkSparseMemoryBind</code>
    structures.
</li></ul></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>buffer</code></em> <span class="normative">must</span> be a valid <code class="code">VkBuffer</code> handle
</li><li class="listitem">
<em class="parameter"><code>pBinds</code></em> <span class="normative">must</span> be a pointer to an array of <em class="parameter"><code>bindCount</code></em> valid <code class="code">VkSparseMemoryBind</code> structures
</li><li class="listitem">
<em class="parameter"><code>bindCount</code></em> <span class="normative">must</span> be greater than <code class="literal">0</code>
</li></ul></div></div><p>Memory is bound to opaque regions of <code class="code">VkImage</code> objects created with the
<code class="code">VK_IMAGE_CREATE_SPARSE_BINDING_BIT</code> flag using the following structure:</p><p><a id="VkSparseImageOpaqueMemoryBindInfo"></a><strong> </strong>
</p><pre class="programlisting">typedef struct VkSparseImageOpaqueMemoryBindInfo {
    VkImage                      image;
    uint32_t                     bindCount;
    const VkSparseMemoryBind*    pBinds;
} VkSparseImageOpaqueMemoryBindInfo;</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>image</code></em> is the <code class="code">VkImage</code> object to be bound.
</li><li class="listitem">
<em class="parameter"><code>bindCount</code></em> is the number of <code class="code">VkSparseMemoryBind</code> structures in
    the <em class="parameter"><code>pBinds</code></em> array.
</li><li class="listitem">
<em class="parameter"><code>pBinds</code></em> is a pointer to array of <code class="code">VkSparseMemoryBind</code>
    structures.
</li></ul></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
For any given element of <em class="parameter"><code>pBinds</code></em>, if the <em class="parameter"><code>flags</code></em> member of that
    element contains <code class="code">VK_SPARSE_MEMORY_BIND_METADATA_BIT</code>, the binding
    range defined <span class="normative">must</span> be within the mip tail region of the metadata aspect
    of <em class="parameter"><code>image</code></em>
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>image</code></em> <span class="normative">must</span> be a valid <code class="code">VkImage</code> handle
</li><li class="listitem">
<em class="parameter"><code>pBinds</code></em> <span class="normative">must</span> be a pointer to an array of <em class="parameter"><code>bindCount</code></em> valid <code class="code">VkSparseMemoryBind</code> structures
</li><li class="listitem">
<em class="parameter"><code>bindCount</code></em> <span class="normative">must</span> be greater than <code class="literal">0</code>
</li></ul></div></div><div class="note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note: Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/icons/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>This operation is normally used to bind memory to fully-resident sparse
images or for mip tail regions of partially resident images.
However, it <span class="normative">can</span> also be used to bind memory for the entire binding range of
partially resident images.</p><p>In case <em class="parameter"><code>flags</code></em> does not contain
<code class="code">VK_SPARSE_MEMORY_BIND_METADATA_BIT</code>, the <em class="parameter"><code>resourceOffset</code></em> is in the
range <span class="eq">[0, <code class="code"><a class="link" href="ch11s06.html#VkMemoryRequirements">VkMemoryRequirements</a></code>::<em class="parameter"><code>size</code></em>)</span>, This range includes
data from all aspects of the image, including metadata.
For most implementations this will probably mean that the
<em class="parameter"><code>resourceOffset</code></em> is a simple device address offset within the resource.
It is possible for an application to bind a range of memory that includes
both resource data and metadata.
However, the application would not know what part of the image the memory is
used for, or if any range is being used for metadata.</p><p>When <em class="parameter"><code>flags</code></em> contains <code class="code">VK_SPARSE_MEMORY_BIND_METADATA_BIT</code>, the
binding range specified <span class="normative">must</span> be within the mip tail region of the metadata
aspect.
In this case the <em class="parameter"><code>resourceOffset</code></em> is not <span class="normative">required</span> to be a simple device
address offset within the resource.
However, it <span class="emphasis"><em>is</em></span> defined to be within [imageMipTailOffset,
imageMipTailOffset + imageMipTailSize) for the metadata aspect.
See <code class="code"><a class="link" href="ch28s07.html#VkSparseMemoryBind">VkSparseMemoryBind</a></code> for the full constraints on binding region with
this flag present.</p></td></tr></table></div><div class="note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note: editing-note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/icons/note.png" /></td><th align="left">editing-note</th></tr><tr><td align="left" valign="top"><p>(Jon) The preceding NOTE refers to <em class="parameter"><code>flags</code></em>, which is presumably a
reference to <code class="code"><a class="link" href="ch28s07.html#VkSparseMemoryBind">VkSparseMemoryBind</a></code> above, even though that is not
contextually clear.</p></td></tr></table></div><p>Memory <span class="normative">can</span> be bound to sparse image blocks of <code class="code">VkImage</code> objects created
with the <code class="code">VK_IMAGE_CREATE_SPARSE_RESIDENCY_BIT</code> flag using the following
structure:</p><p><a id="VkSparseImageMemoryBindInfo"></a><strong> </strong>
</p><pre class="programlisting">typedef struct VkSparseImageMemoryBindInfo {
    VkImage                           image;
    uint32_t                          bindCount;
    const VkSparseImageMemoryBind*    pBinds;
} VkSparseImageMemoryBindInfo;</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>image</code></em> is the <code class="code">VkImage</code> object to be bound
</li><li class="listitem">
<em class="parameter"><code>bindCount</code></em> is the number of <code class="code">VkSparseImageMemoryBind</code>
    structures in pBinds array
</li><li class="listitem">
<em class="parameter"><code>pBinds</code></em> is a pointer to array of <code class="code">VkSparseImageMemoryBind</code>
    structures
</li></ul></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>image</code></em> <span class="normative">must</span> be a valid <code class="code">VkImage</code> handle
</li><li class="listitem">
<em class="parameter"><code>pBinds</code></em> <span class="normative">must</span> be a pointer to an array of <em class="parameter"><code>bindCount</code></em> valid <code class="code">VkSparseImageMemoryBind</code> structures
</li><li class="listitem">
<em class="parameter"><code>bindCount</code></em> <span class="normative">must</span> be greater than <code class="literal">0</code>
</li></ul></div></div><p>The <code class="code">VkSparseImageMemoryBind</code> structure is defined as:</p><p><a id="VkSparseImageMemoryBind"></a><strong> </strong>
</p><pre class="programlisting">typedef struct VkSparseImageMemoryBind {
    VkImageSubresource         subresource;
    VkOffset3D                 offset;
    VkExtent3D                 extent;
    VkDeviceMemory             memory;
    VkDeviceSize               memoryOffset;
    VkSparseMemoryBindFlags    flags;
} VkSparseImageMemoryBind;</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>subresource</code></em> is the aspectMask and region of interest in the image.
</li><li class="listitem">
<em class="parameter"><code>offset</code></em> are the coordinates of the first texel within the image
    subresource to bind.
</li><li class="listitem">
<em class="parameter"><code>extent</code></em> is the size in texels of the region within the image
    subresource to bind.
    The extent <span class="normative">must</span> be a multiple of the sparse image block dimensions,
    except when binding sparse image blocks along the edge of an image
    subresource it <span class="normative">can</span> instead be such that any coordinate of
    <span class="eq"><em class="parameter"><code>offset</code></em> + <em class="parameter"><code>extent</code></em></span> equals the corresponding dimensions of
    the image subresource.
</li><li class="listitem">
<em class="parameter"><code>memory</code></em> is the <code class="code">VkDeviceMemory</code> object that the sparse image
    blocks of the image are bound to.
    If <em class="parameter"><code>memory</code></em> is <code class="code"><a class="link" href="apds03.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></code>, the sparse image blocks are
    unbound.
</li><li class="listitem">
<em class="parameter"><code>memoryOffset</code></em> is an offset into <code class="code">VkDeviceMemory</code> object.
    If <em class="parameter"><code>memory</code></em> is <code class="code"><a class="link" href="apds03.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></code>, this value is ignored.
</li><li class="listitem">
<em class="parameter"><code>flags</code></em> are sparse memory binding flags.
</li></ul></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
If the <a class="link" href="ch31s01.html#features-features-sparseResidencyAliased">sparse aliased     residency</a> feature is not enabled, and if any other resources are bound
    to ranges of <em class="parameter"><code>memory</code></em>, the range of <em class="parameter"><code>memory</code></em> being bound <span class="normative">must</span>
    not overlap with those bound ranges
</li><li class="listitem">
<em class="parameter"><code>memory</code></em> and <em class="parameter"><code>memoryOffset</code></em> <span class="normative">must</span> match the memory requirements
    of the calling command’s <em class="parameter"><code>image</code></em>, as described in section
    <a class="xref" href="ch11s06.html" title="11.6. Resource Memory Association">Section 11.6, “Resource Memory Association”</a>
</li><li class="listitem">
<em class="parameter"><code>subresource</code></em> <span class="normative">must</span> be a valid image subresource for <em class="parameter"><code>image</code></em>
    (see <a class="xref" href="ch11s05.html" title="11.5. Image Views">Section 11.5, “Image Views”</a>)
</li><li class="listitem">
<em class="parameter"><code>offset.x</code></em> <span class="normative">must</span> be a multiple of the sparse image block width
    (<code class="code">VkSparseImageFormatProperties</code>::<em class="parameter"><code>imageGranularity.width</code></em>) of
    the image
</li><li class="listitem">
<em class="parameter"><code>extent.width</code></em> <span class="normative">must</span> either be a multiple of the sparse image block
    width of the image, or else <em class="parameter"><code>extent.width</code></em> + <em class="parameter"><code>offset.x</code></em> <span class="normative">must</span>
    equal the width of the image subresource
</li><li class="listitem">
<em class="parameter"><code>offset.y</code></em> <span class="normative">must</span> be a multiple of the sparse image block height
    (<code class="code">VkSparseImageFormatProperties</code>::<em class="parameter"><code>imageGranularity.height</code></em>) of
    the image
</li><li class="listitem">
<em class="parameter"><code>extent.height</code></em> <span class="normative">must</span> either be a multiple of the sparse image block
    height of the image, or else <em class="parameter"><code>extent.height</code></em> + <em class="parameter"><code>offset.y</code></em> <span class="normative">must</span>
    equal the height of the image subresource
</li><li class="listitem">
<em class="parameter"><code>offset.z</code></em> <span class="normative">must</span> be a multiple of the sparse image block depth
    (<code class="code">VkSparseImageFormatProperties</code>::<em class="parameter"><code>imageGranularity.depth</code></em>) of
    the image
</li><li class="listitem">
<em class="parameter"><code>extent.depth</code></em> <span class="normative">must</span> either be a multiple of the sparse image block
    depth of the image, or else <em class="parameter"><code>extent.depth</code></em> + <em class="parameter"><code>offset.z</code></em> <span class="normative">must</span>
    equal the depth of the image subresource
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>subresource</code></em> <span class="normative">must</span> be a valid <code class="code">VkImageSubresource</code> structure
</li><li class="listitem">
If <em class="parameter"><code>memory</code></em> is not <code class="code"><a class="link" href="apds03.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></code>, <em class="parameter"><code>memory</code></em> <span class="normative">must</span> be a valid <code class="code">VkDeviceMemory</code> handle
</li><li class="listitem">
<em class="parameter"><code>flags</code></em> <span class="normative">must</span> be a valid combination of <code class="code"><a class="link" href="ch28s07.html#VkSparseMemoryBindFlagBits">VkSparseMemoryBindFlagBits</a></code> values
</li></ul></div></div><p>To submit sparse binding operations to a queue, call:</p><p><a id="vkQueueBindSparse"></a><strong> </strong>
</p><pre class="programlisting">VkResult vkQueueBindSparse(
    VkQueue                                     queue,
    uint32_t                                    bindInfoCount,
    const VkBindSparseInfo*                     pBindInfo,
    VkFence                                     fence);</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>queue</code></em> is the queue that the sparse binding operations will be
    submitted to.
</li><li class="listitem">
<em class="parameter"><code>bindInfoCount</code></em> is the number of elements in the <em class="parameter"><code>pBindInfo</code></em>
    array.
</li><li class="listitem">
<em class="parameter"><code>pBindInfo</code></em> is an array of <code class="code"><a class="link" href="ch28s07.html#VkBindSparseInfo">VkBindSparseInfo</a></code> structures, each
    specifying a sparse binding submission batch.
</li><li class="listitem">
<em class="parameter"><code>fence</code></em> is an optional handle to a fence to be signaled.
    If <em class="parameter"><code>fence</code></em> is not <code class="code"><a class="link" href="apds03.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></code>, it defines a
    <a class="link" href="ch06s01.html#synchronization-fences-signaling">fence signal operation</a>.
</li></ul></div><p><span class="strong"><strong><code class="code">vkQueueBindSparse</code></strong></span> is a <a class="link" href="ch04s03.html#devsandqueues-submission" title="4.3.5. Queue Submission">queue submission command</a>, with each batch defined by an element of <em class="parameter"><code>pBindInfo</code></em> as an
instance of the <code class="code"><a class="link" href="ch28s07.html#VkBindSparseInfo">VkBindSparseInfo</a></code> structure.</p><p>Within a batch, a given range of a resource <span class="normative">must</span> not be bound more than
once.
Across batches, if a range is to be bound to one allocation and offset and
then to another allocation and offset, then the application <span class="normative">must</span> guarantee
(usually using semaphores) that the binding operations are executed in the
correct order, as well as to order binding operations against the execution
of command buffer submissions.</p><p>As no operation to <code class="code"><a class="link" href="ch28s07.html#vkQueueBindSparse">vkQueueBindSparse</a></code> causes any pipeline stage to
access memory, synchronization primitives used in this command effectively
only define execution dependencies.</p><p>Additional information about fence and semaphore operation is described in
<a class="link" href="ch06.html" title="Chapter 6. Synchronization and Cache Control">the synchronization chapter</a>.</p><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>fence</code></em> <span class="normative">must</span> be unsignaled
</li><li class="listitem">
<em class="parameter"><code>fence</code></em> <span class="normative">must</span> not be associated with any other queue command that
    has not yet completed execution on that queue
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>queue</code></em> <span class="normative">must</span> be a valid <code class="code">VkQueue</code> handle
</li><li class="listitem">
If <em class="parameter"><code>bindInfoCount</code></em> is not <code class="literal">0</code>, <em class="parameter"><code>pBindInfo</code></em> <span class="normative">must</span> be a pointer to an array of <em class="parameter"><code>bindInfoCount</code></em> valid <code class="code">VkBindSparseInfo</code> structures
</li><li class="listitem">
If <em class="parameter"><code>fence</code></em> is not <code class="code"><a class="link" href="apds03.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></code>, <em class="parameter"><code>fence</code></em> <span class="normative">must</span> be a valid <code class="code">VkFence</code> handle
</li><li class="listitem">
The <em class="parameter"><code>queue</code></em> <span class="normative">must</span> support sparse binding operations
</li><li class="listitem">
Both of <em class="parameter"><code>fence</code></em>, and <em class="parameter"><code>queue</code></em> that are valid handles <span class="normative">must</span> have been created, allocated, or retrieved from the same <code class="code">VkDevice</code>
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Host Synchronization</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
Host access to <em class="parameter"><code>queue</code></em> <span class="normative">must</span> be externally synchronized
</li><li class="listitem">
Host access to <em class="parameter"><code>pBindInfo</code></em>[].pWaitSemaphores[] <span class="normative">must</span> be externally synchronized
</li><li class="listitem">
Host access to <em class="parameter"><code>pBindInfo</code></em>[].pSignalSemaphores[] <span class="normative">must</span> be externally synchronized
</li><li class="listitem">
Host access to <em class="parameter"><code>pBindInfo</code></em>[].pBufferBinds[].buffer <span class="normative">must</span> be externally synchronized
</li><li class="listitem">
Host access to <em class="parameter"><code>pBindInfo</code></em>[].pImageOpaqueBinds[].image <span class="normative">must</span> be externally synchronized
</li><li class="listitem">
Host access to <em class="parameter"><code>pBindInfo</code></em>[].pImageBinds[].image <span class="normative">must</span> be externally synchronized
</li><li class="listitem">
Host access to <em class="parameter"><code>fence</code></em> <span class="normative">must</span> be externally synchronized
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Command Properties</strong></p></div></div></div><div class="informaltable"><table class="informaltable" cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; border-left: 3px solid #527bbd; border-right: 3px solid #527bbd; " width="100%"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top">Command Buffer Levels</th><th style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top">Render Pass Scope</th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top">Supported Queue Types</th></tr></thead><tbody><tr><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><p>-</p></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><p>-</p></td><td style="" align="left" valign="top"><p>SPARSE_BINDING</p></td></tr></tbody></table></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Return Codes</strong></p></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<a class="link" href="ch02s06.html#fundamentals-successcodes" title="Success Codes">Success</a>
</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="code">VK_SUCCESS</code>
</li></ul></div></dd><dt><span class="term">
<a class="link" href="ch02s06.html#fundamentals-errorcodes" title="Error codes">Failure</a>
</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="code">VK_ERROR_OUT_OF_HOST_MEMORY</code>
</li><li class="listitem">
<code class="code">VK_ERROR_OUT_OF_DEVICE_MEMORY</code>
</li><li class="listitem">
<code class="code">VK_ERROR_DEVICE_LOST</code>
</li></ul></div></dd></dl></div></div><p>The <code class="code">VkBindSparseInfo</code> structure is defined as:</p><p><a id="VkBindSparseInfo"></a><strong> </strong>
</p><pre class="programlisting">typedef struct VkBindSparseInfo {
    VkStructureType                             sType;
    const void*                                 pNext;
    uint32_t                                    waitSemaphoreCount;
    const VkSemaphore*                          pWaitSemaphores;
    uint32_t                                    bufferBindCount;
    const VkSparseBufferMemoryBindInfo*         pBufferBinds;
    uint32_t                                    imageOpaqueBindCount;
    const VkSparseImageOpaqueMemoryBindInfo*    pImageOpaqueBinds;
    uint32_t                                    imageBindCount;
    const VkSparseImageMemoryBindInfo*          pImageBinds;
    uint32_t                                    signalSemaphoreCount;
    const VkSemaphore*                          pSignalSemaphores;
} VkBindSparseInfo;</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>sType</code></em> is the type of this structure.
</li><li class="listitem">
<em class="parameter"><code>pNext</code></em> is <code class="literal">NULL</code> or a pointer to an extension-specific structure.
</li><li class="listitem">
<em class="parameter"><code>waitSemaphoreCount</code></em> is the number of semaphores upon which to wait
    before executing the sparse binding operations for the batch.
</li><li class="listitem">
<em class="parameter"><code>pWaitSemaphores</code></em> is a pointer to an array of semaphores upon which
    to wait on before the sparse binding operations for this batch begin
    execution.
    If semaphores to wait on are provided, they define a
    <a class="link" href="ch06s02.html#synchronization-semaphores-waiting">semaphore wait operation</a>.
</li><li class="listitem">
<em class="parameter"><code>bufferBindCount</code></em> is the number of sparse buffer bindings to perform
    in the batch.
</li><li class="listitem">
<em class="parameter"><code>pBufferBinds</code></em> is a pointer to an array of
    <code class="code"><a class="link" href="ch28s07.html#VkSparseBufferMemoryBindInfo">VkSparseBufferMemoryBindInfo</a></code> structures.
</li><li class="listitem">
<em class="parameter"><code>imageOpaqueBindCount</code></em> is the number of opaque sparse image bindings
    to perform.
</li><li class="listitem">
<em class="parameter"><code>pImageOpaqueBinds</code></em> is a pointer to an array of
    <code class="code"><a class="link" href="ch28s07.html#VkSparseImageOpaqueMemoryBindInfo">VkSparseImageOpaqueMemoryBindInfo</a></code> structures, indicating opaque
    sparse image bindings to perform.
</li><li class="listitem">
<em class="parameter"><code>imageBindCount</code></em> is the number of sparse image bindings to perform.
</li><li class="listitem">
<em class="parameter"><code>pImageBinds</code></em> is a pointer to an array of
    <code class="code"><a class="link" href="ch28s07.html#VkSparseImageMemoryBindInfo">VkSparseImageMemoryBindInfo</a></code> structures, indicating sparse image
    bindings to perform.
</li><li class="listitem">
<em class="parameter"><code>signalSemaphoreCount</code></em> is the number of semaphores to be signaled
    once the sparse binding operations specified by the structure have
    completed execution.
</li><li class="listitem">
<em class="parameter"><code>pSignalSemaphores</code></em> is a pointer to an array of semaphores which
    will be signaled when the sparse binding operations for this batch have
    completed execution.
    If semaphores to be signaled are provided, they define a
    <a class="link" href="ch06s02.html#synchronization-semaphores-signaling">semaphore signal operation</a>.
</li></ul></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>sType</code></em> <span class="normative">must</span> be <code class="code">VK_STRUCTURE_TYPE_BIND_SPARSE_INFO</code>
</li><li class="listitem">
<em class="parameter"><code>pNext</code></em> <span class="normative">must</span> be <code class="literal">NULL</code>
</li><li class="listitem">
If <em class="parameter"><code>waitSemaphoreCount</code></em> is not <code class="literal">0</code>, <em class="parameter"><code>pWaitSemaphores</code></em> <span class="normative">must</span> be a pointer to an array of <em class="parameter"><code>waitSemaphoreCount</code></em> valid <code class="code">VkSemaphore</code> handles
</li><li class="listitem">
If <em class="parameter"><code>bufferBindCount</code></em> is not <code class="literal">0</code>, <em class="parameter"><code>pBufferBinds</code></em> <span class="normative">must</span> be a pointer to an array of <em class="parameter"><code>bufferBindCount</code></em> valid <code class="code">VkSparseBufferMemoryBindInfo</code> structures
</li><li class="listitem">
If <em class="parameter"><code>imageOpaqueBindCount</code></em> is not <code class="literal">0</code>, <em class="parameter"><code>pImageOpaqueBinds</code></em> <span class="normative">must</span> be a pointer to an array of <em class="parameter"><code>imageOpaqueBindCount</code></em> valid <code class="code">VkSparseImageOpaqueMemoryBindInfo</code> structures
</li><li class="listitem">
If <em class="parameter"><code>imageBindCount</code></em> is not <code class="literal">0</code>, <em class="parameter"><code>pImageBinds</code></em> <span class="normative">must</span> be a pointer to an array of <em class="parameter"><code>imageBindCount</code></em> valid <code class="code">VkSparseImageMemoryBindInfo</code> structures
</li><li class="listitem">
If <em class="parameter"><code>signalSemaphoreCount</code></em> is not <code class="literal">0</code>, <em class="parameter"><code>pSignalSemaphores</code></em> <span class="normative">must</span> be a pointer to an array of <em class="parameter"><code>signalSemaphoreCount</code></em> valid <code class="code">VkSemaphore</code> handles
</li><li class="listitem">
Both of the elements of <em class="parameter"><code>pSignalSemaphores</code></em>, and the elements of <em class="parameter"><code>pWaitSemaphores</code></em> that are valid handles <span class="normative">must</span> have been created, allocated, or retrieved from the same <code class="code">VkDevice</code>
</li></ul></div></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch28s06.html"><img src="images/icons/prev.png" alt="Prev" /></a> </td><td width="20%" align="center"><a accesskey="u" href="ch28.html"><img src="images/icons/up.png" alt="Up" /></a></td><td width="40%" align="right"> <a accesskey="n" href="ch28s08.html"><img src="images/icons/next.png" alt="Next" /></a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/icons/home.png" alt="Home" /></a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>