<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>32.2. Debug Report Callbacks</title><link rel="stylesheet" type="text/css" href="config/vkspec-xhtml.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="Vulkan 1.0.30 - A Specification (with WSI extensions)" /><link rel="up" href="ch32.html" title="Chapter 32. Debugging" /><link rel="prev" href="ch32s01.html" title="32.1. Debug Markers" /><link rel="next" href="apa.html" title="Appendix A. Vulkan Environment for SPIR-V" /><script xmlns="" type="text/x-mathjax-config">
        MathJax.Hub.Config({
            MathML: { extensions: ["content-mathml.js"] },
            tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] }
        });
    </script><script xmlns="" type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="p" href="ch32s01.html"><img src="images/icons/prev.png" alt="Prev" /></a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="apa.html"><img src="images/icons/next.png" alt="Next" /></a></td></tr></table><hr /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="debugging-debug-report-callbacks"></a>32.2. Debug Report Callbacks</h2></div></div></div><p>Debug report callbacks give more detailed feedback on the application’s use
of Vulkan when events of interest occur.</p><p>To register a debug report callback, an application uses
<code class="code"><a class="link" href="ch32s02.html#vkCreateDebugReportCallbackEXT">vkCreateDebugReportCallbackEXT</a></code>.</p><p><a id="vkCreateDebugReportCallbackEXT"></a><strong> </strong>
</p><pre class="programlisting">VkResult vkCreateDebugReportCallbackEXT(
    VkInstance                                  instance,
    const VkDebugReportCallbackCreateInfoEXT*   pCreateInfo,
    const VkAllocationCallbacks*                pAllocator,
    VkDebugReportCallbackEXT*                   pCallback);</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>instance</code></em> the instance the callback will be logged on.
</li><li class="listitem">
<em class="parameter"><code>pCreateInfo</code></em> points to a <code class="code"><a class="link" href="ch32s02.html#VkDebugReportCallbackCreateInfoEXT">VkDebugReportCallbackCreateInfoEXT</a></code>
    structure which defines the conditions under which this callback will be
    called.
</li><li class="listitem">
<em class="parameter"><code>pCallback</code></em> is a pointer to record the
    <code class="code">VkDebugReportCallbackEXT</code> object created.
</li></ul></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>instance</code></em> <span class="normative">must</span> be a valid <code class="code">VkInstance</code> handle
</li><li class="listitem">
<em class="parameter"><code>pCreateInfo</code></em> <span class="normative">must</span> be a pointer to a valid <code class="code">VkDebugReportCallbackCreateInfoEXT</code> structure
</li><li class="listitem">
If <em class="parameter"><code>pAllocator</code></em> is not <code class="literal">NULL</code>, <em class="parameter"><code>pAllocator</code></em> <span class="normative">must</span> be a pointer to a valid <code class="code">VkAllocationCallbacks</code> structure
</li><li class="listitem">
<em class="parameter"><code>pCallback</code></em> <span class="normative">must</span> be a pointer to a <code class="code">VkDebugReportCallbackEXT</code> handle
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Return Codes</strong></p></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<a class="link" href="ch02s06.html#fundamentals-successcodes" title="Success Codes">Success</a>
</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="code">VK_SUCCESS</code>
</li></ul></div></dd><dt><span class="term">
<a class="link" href="ch02s06.html#fundamentals-errorcodes" title="Error codes">Failure</a>
</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="code">VK_ERROR_OUT_OF_HOST_MEMORY</code>
</li></ul></div></dd></dl></div></div><p><a id="VkDebugReportErrorEXT"></a><strong> </strong>
</p><pre class="programlisting">typedef enum VkDebugReportErrorEXT {
    VK_DEBUG_REPORT_ERROR_NONE_EXT = 0,
    VK_DEBUG_REPORT_ERROR_CALLBACK_REF_EXT = 1,
} VkDebugReportErrorEXT;</pre><p>
</p><div class="note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note: Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/icons/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The <code class="literal">VK_EXT_debug_report</code> extension defines the <code class="code"><a class="link" href="ch32s02.html#VkDebugReportErrorEXT">VkDebugReportErrorEXT</a></code>
enumerant type, but does not currently explain what the enumeration is used
for.
It is included here for completeness.</p></td></tr></table></div><p>The definition of <code class="code"><a class="link" href="ch32s02.html#VkDebugReportCallbackCreateInfoEXT">VkDebugReportCallbackCreateInfoEXT</a></code> is:</p><p><a id="VkDebugReportCallbackCreateInfoEXT"></a><strong> </strong>
</p><pre class="programlisting">typedef struct VkDebugReportCallbackCreateInfoEXT {
    VkStructureType                 sType;
    const void*                     pNext;
    VkDebugReportFlagsEXT           flags;
    PFN_vkDebugReportCallbackEXT    pfnCallback;
    void*                           pUserData;
} VkDebugReportCallbackCreateInfoEXT;</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>sType</code></em> is the type of this structure.
</li><li class="listitem">
<em class="parameter"><code>pNext</code></em> is <code class="literal">NULL</code> or a pointer to an extension-specific structure.
</li><li class="listitem"><p class="simpara">
<em class="parameter"><code>flags</code></em> indicate which event(s) will cause this callback to be
    called.
    Flags are interpreted as bitmasks and multiple may be set.
    Bits which <span class="normative">can</span> be set include:
</p><p><a id="VkDebugReportFlagBitsEXT"></a><strong> </strong>
</p><pre class="programlisting">typedef enum VkDebugReportFlagBitsEXT {
    VK_DEBUG_REPORT_INFORMATION_BIT_EXT = 0x00000001,
    VK_DEBUG_REPORT_WARNING_BIT_EXT = 0x00000002,
    VK_DEBUG_REPORT_PERFORMANCE_WARNING_BIT_EXT = 0x00000004,
    VK_DEBUG_REPORT_ERROR_BIT_EXT = 0x00000008,
    VK_DEBUG_REPORT_DEBUG_BIT_EXT = 0x00000010,
} VkDebugReportFlagBitsEXT;</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<code class="code">VK_DEBUG_REPORT_ERROR_BIT_EXT</code> indicates an error that may cause
    undefined results, including an application crash.
</li><li class="listitem">
<code class="code">VK_DEBUG_REPORT_WARNING_BIT_EXT</code> indicates an unexpected use.
    E.g. Not destroying objects prior to destroying the containing object or
    potential inconsistencies between descriptor set layout and the layout
    in the corresponding shader, etc.
</li><li class="listitem">
<code class="code">VK_DEBUG_REPORT_PERFORMANCE_WARNING_BIT_EXT</code> indicates a
    potentially non-optimal use of Vulkan.
    E.g. using <code class="code"><a class="link" href="ch17s01.html#vkCmdClearColorImage">vkCmdClearColorImage</a></code> when a RenderPass load_op would
    have worked.
</li><li class="listitem">
<code class="code">VK_DEBUG_REPORT_INFORMATION_BIT_EXT</code> indicates an informational
    message such as resource details that may be handy when debugging an
    application.
</li><li class="listitem">
<code class="code">VK_DEBUG_REPORT_DEBUG_BIT_EXT</code> indicates diagnostic information
    from the loader and layers.
</li><li class="listitem">
<em class="parameter"><code>pfnCallback</code></em> is the application callback function to call.
</li><li class="listitem">
<em class="parameter"><code>pUserData</code></em> is user data to be passed to the callback.
</li></ul></div></li></ul></div><p>For each <code class="code">VkDebugReportCallbackEXT</code> that is created the flags determine
when that function is called.
A callback will be made for issues that match any bit set in its flags.
The callback will come directly from the component that detected the event,
unless some other layer intercepts the calls for its own purposes (filter
them in different way, log to system error log, etc.) An application may
receive multiple callbacks if multiple <code class="code">VkDebugReportCallbackEXT</code>
objects were created.
A callback will always be executed in the same thread as the originating
Vulkan call.
A callback may be called from multiple threads simultaneously (if the
application is making Vulkan calls from multiple threads).</p><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>sType</code></em> <span class="normative">must</span> be <code class="code">VK_STRUCTURE_TYPE_DEBUG_REPORT_CALLBACK_CREATE_INFO_EXT</code>
</li><li class="listitem">
<em class="parameter"><code>pNext</code></em> <span class="normative">must</span> be <code class="literal">NULL</code>
</li><li class="listitem">
<em class="parameter"><code>flags</code></em> <span class="normative">must</span> be a valid combination of <code class="code"><a class="link" href="ch32s02.html#VkDebugReportFlagBitsEXT">VkDebugReportFlagBitsEXT</a></code> values
</li><li class="listitem">
<em class="parameter"><code>flags</code></em> <span class="normative">must</span> not be <code class="literal">0</code>
</li></ul></div></div><p>The prototype for the callback function implemented by the application is:</p><p><a id="PFN_vkDebugReportCallbackEXT"></a><strong> </strong>
</p><pre class="programlisting">typedef VkBool32 (VKAPI_PTR *PFN_vkDebugReportCallbackEXT)(
    VkDebugReportFlagsEXT                       flags,
    VkDebugReportObjectTypeEXT                  objectType,
    uint64_t                                    object,
    size_t                                      location,
    int32_t                                     messageCode,
    const char*                                 pLayerPrefix,
    const char*                                 pMessage,
    void*                                       pUserData);</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>flags</code></em> indicates the <code class="code">VkDebugReportFlagBitsEXT</code> that triggered
    this callback.
</li><li class="listitem">
<em class="parameter"><code>objType</code></em> is a <code class="code"><a class="link" href="ch32s01.html#VkDebugReportObjectTypeEXT">VkDebugReportObjectTypeEXT</a></code> specifying the type
    of object being used or created at the time the event was triggered.
</li><li class="listitem">
<em class="parameter"><code>object</code></em> gives the object where the issue was detected.
    <em class="parameter"><code>object</code></em> may be <code class="code">VK_NULL_OBJECT</code> if there is no object
    associated with the event.
</li><li class="listitem">
<em class="parameter"><code>location</code></em> is a component (layer, driver, loader) defined value that
    indicates the <span class="emphasis"><em>location</em></span> of the trigger.
    This is an optional value.
</li><li class="listitem">
<em class="parameter"><code>messageCode</code></em> is a layer-defined value indicating what test
    triggered this callback.
</li><li class="listitem">
<em class="parameter"><code>pLayerPrefix</code></em> is the abbreviation of the component making the
    callback.
</li><li class="listitem">
<em class="parameter"><code>pMessage</code></em> is a null-terminated string detailing the trigger
    conditions.
</li><li class="listitem">
<em class="parameter"><code>pUserData</code></em> is the user data given when the DebugReportCallback was
    created.
</li></ul></div><p>The callback returns a <code class="code">VkBool32</code> that indicates to the calling layer
if the Vulkan call <span class="normative">should</span> be aborted or not.
Applications <span class="normative">should</span> always return <code class="code">VK_FALSE</code> so that they see the same
behavior with and without validation layers enabled.</p><p>If the application returns <code class="code">VK_TRUE</code> from its callback and the Vulkan
call being aborted returns a <code class="code"><a class="link" href="ch02s06.html#VkResult">VkResult</a></code>, the layer will return
<code class="code">VK_ERROR_VALIDATION_FAILED_EXT</code>.</p><div class="note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note: Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/icons/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The primary expected use of <code class="code">VK_ERROR_VALIDATION_FAILED_EXT</code> is for
validation layer testing.
It is not expected that an application would see this error code during
normal use of the validation layers.</p></td></tr></table></div><p>To inject its own messages into the debug stream, call:</p><p><a id="vkDebugReportMessageEXT"></a><strong> </strong>
</p><pre class="programlisting">void vkDebugReportMessageEXT(
    VkInstance                                  instance,
    VkDebugReportFlagsEXT                       flags,
    VkDebugReportObjectTypeEXT                  objectType,
    uint64_t                                    object,
    size_t                                      location,
    int32_t                                     messageCode,
    const char*                                 pLayerPrefix,
    const char*                                 pMessage);</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>instance</code></em> the instance the callback will be logged on.
</li><li class="listitem">
<em class="parameter"><code>flags</code></em> indicates the <code class="code">VkDebugReportFlagBitsEXT</code> that triggered
    this callback.
</li><li class="listitem">
<em class="parameter"><code>objType</code></em> is a <code class="code"><a class="link" href="ch32s01.html#VkDebugReportObjectTypeEXT">VkDebugReportObjectTypeEXT</a></code> specifying the type
    of object being used or created at the time the event was triggered.
</li><li class="listitem">
<em class="parameter"><code>object</code></em> is object where the issue was detected.
    <em class="parameter"><code>object</code></em> may be <code class="code">VK_NULL_OBJECT</code> if there is no object
    associated with the event.
</li><li class="listitem">
<em class="parameter"><code>location</code></em> is a component (layer, driver, loader) defined value that
    indicates the <span class="emphasis"><em>location</em></span> of the trigger.
    This is an optional value.
</li><li class="listitem">
<em class="parameter"><code>messageCode</code></em> is a layer-defined value indicating what test
    triggered this callback.
</li><li class="listitem">
<em class="parameter"><code>pLayerPrefix</code></em> is the abbreviation of the component making the
    callback.
</li><li class="listitem">
<em class="parameter"><code>pMessage</code></em> is a null-terminated string detailing the trigger
    conditions.
</li></ul></div><p>The call will propagate through the layers and cause a callback to the
application.
The parameters are passed on to the callback in addition to the
<em class="parameter"><code>pUserData</code></em> value that was defined at the time the callback was
registered.</p><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>instance</code></em> <span class="normative">must</span> be a valid <code class="code">VkInstance</code> handle
</li><li class="listitem">
<em class="parameter"><code>flags</code></em> <span class="normative">must</span> be a combination of one or more of
    <code class="code">VkDebugReportFlagBitsEXT</code>
</li><li class="listitem">
<em class="parameter"><code>objType</code></em> <span class="normative">must</span> be one of <code class="code">VkDebugReportObjectTypeEXT</code>,
    <code class="code">VK_DEBUG_REPORT_OBJECT_TYPE_UNKNOWN_EXT</code> if <em class="parameter"><code>object</code></em> is <code class="literal">NULL</code>
</li><li class="listitem">
<em class="parameter"><code>object</code></em> <span class="normative">may</span> be a Vulkan object
</li><li class="listitem">
<em class="parameter"><code>pLayerPrefix</code></em> <span class="normative">must</span> be a <code class="literal">NULL</code> terminated string
</li><li class="listitem">
<em class="parameter"><code>pMsg</code></em> <span class="normative">must</span> be a <code class="literal">NULL</code> terminated string
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>instance</code></em> <span class="normative">must</span> be a valid <code class="code">VkInstance</code> handle
</li><li class="listitem">
<em class="parameter"><code>flags</code></em> <span class="normative">must</span> be a valid combination of <code class="code"><a class="link" href="ch32s02.html#VkDebugReportFlagBitsEXT">VkDebugReportFlagBitsEXT</a></code> values
</li><li class="listitem">
<em class="parameter"><code>flags</code></em> <span class="normative">must</span> not be <code class="literal">0</code>
</li><li class="listitem">
<em class="parameter"><code>objectType</code></em> <span class="normative">must</span> be a valid <code class="code"><a class="link" href="ch32s01.html#VkDebugReportObjectTypeEXT">VkDebugReportObjectTypeEXT</a></code> value
</li><li class="listitem">
<em class="parameter"><code>pLayerPrefix</code></em> <span class="normative">must</span> be a pointer to a valid
</li><li class="listitem">
<em class="parameter"><code>pMessage</code></em> <span class="normative">must</span> be a pointer to a valid
</li></ul></div></div><p>To destroy a <code class="code">VkDebugReportCallbackEXT</code> object, call:</p><p><a id="vkDestroyDebugReportCallbackEXT"></a><strong> </strong>
</p><pre class="programlisting">void vkDestroyDebugReportCallbackEXT(
    VkInstance                                  instance,
    VkDebugReportCallbackEXT                    callback,
    const VkAllocationCallbacks*                pAllocator);</pre><p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>instance</code></em> the instance where the callback was created.
</li><li class="listitem">
<em class="parameter"><code>callback</code></em> the <code class="code">VkDebugReportCallbackEXT</code> object to destroy.
</li></ul></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
If <code class="code">VkAllocationCallbacks</code> were provided when <em class="parameter"><code>instance</code></em> was
    created, a compatible set of callbacks <span class="normative">must</span> be provided here
</li><li class="listitem">
If no <code class="code">VkAllocationCallbacks</code> were provided when <em class="parameter"><code>instance</code></em> was
    created, <em class="parameter"><code>pAllocator</code></em> <span class="normative">must</span> be <code class="literal">NULL</code>
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Valid Usage (Implicit)</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>instance</code></em> <span class="normative">must</span> be a valid <code class="code">VkInstance</code> handle
</li><li class="listitem">
<em class="parameter"><code>callback</code></em> <span class="normative">must</span> be a valid <code class="code">VkDebugReportCallbackEXT</code> handle
</li><li class="listitem">
If <em class="parameter"><code>pAllocator</code></em> is not <code class="literal">NULL</code>, <em class="parameter"><code>pAllocator</code></em> <span class="normative">must</span> be a pointer to a valid <code class="code">VkAllocationCallbacks</code> structure
</li><li class="listitem">
<em class="parameter"><code>callback</code></em> <span class="normative">must</span> have been created, allocated, or retrieved from <em class="parameter"><code>instance</code></em>
</li></ul></div></div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong>Host Synchronization</strong></p></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
Host access to <em class="parameter"><code>callback</code></em> <span class="normative">must</span> be externally synchronized
</li></ul></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch32s01.html"><img src="images/icons/prev.png" alt="Prev" /></a> </td><td width="20%" align="center"><a accesskey="u" href="ch32.html"><img src="images/icons/up.png" alt="Up" /></a></td><td width="40%" align="right"> <a accesskey="n" href="apa.html"><img src="images/icons/next.png" alt="Next" /></a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/icons/home.png" alt="Home" /></a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>